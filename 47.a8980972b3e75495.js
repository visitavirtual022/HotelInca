"use strict";(self.webpackChunktourmkr_download=self.webpackChunktourmkr_download||[]).push([[47],{945:(L,T,l)=>{l.d(T,{F:()=>v});var d=l(2409),_=l(3637),C=l(6561);function v(p=0,m=_.P){return(!(0,C.k)(p)||p<0)&&(p=0),(!m||"function"!=typeof m.schedule)&&(m=_.P),new d.y(h=>(h.add(m.schedule(u,p,{subscriber:h,counter:0,period:p})),h))}function u(p){const{subscriber:m,counter:h,period:f}=p;m.next(h),this.schedule({subscriber:m,counter:h+1,period:f},f)}},7591:(L,T,l)=>{l.d(T,{I:()=>v});var d=l(4537),_=l(8692);const C=["ref"];let v=(()=>{class u{constructor(){this.standart=!0,this.pos={left:0,top:0}}}return u.\u0275fac=function(m){return new(m||u)},u.\u0275cmp=d.Xpm({type:u,selectors:[["sh-tool-tip"]],viewQuery:function(m,h){if(1&m&&d.Gf(C,5,d.SBq),2&m){let f;d.iGM(f=d.CRH())&&(h.ref=f.first)}},inputs:{position:"position",standart:"standart"},decls:3,vars:10,consts:[[1,"sh-tooltip",3,"ngClass"],["ref",""]],template:function(m,h){1&m&&(d.TgZ(0,"span",0,1),d._uU(2),d.qZA()),2&m&&(d.Udp("left",h.pos.left,"px")("top",h.pos.top,"px"),d.ekj("show",h.show)("standart",h.standart),d.Q6J("ngClass",h.position),d.xp6(2),d.Oqu(h.text))},dependencies:[_.mk],styles:["span[_ngcontent-%COMP%]{position:absolute;top:0;font-size:12px;left:0;padding:2px 8px;background:inherit;color:inherit;border-radius:3px;white-space:nowrap;visibility:hidden;opacity:0;z-index:999;cursor:default}span.show[_ngcontent-%COMP%]{visibility:visible;opacity:1}span.standart[_ngcontent-%COMP%]{background:rgba(0,0,0,.5);color:#fff}span.above[_ngcontent-%COMP%]{transform:translate(-50%,-100%)}span.below[_ngcontent-%COMP%]{transform:translate(-50%)}span.before[_ngcontent-%COMP%]{transform:translate(-100%,-50%)}span.after[_ngcontent-%COMP%]{transform:translateY(-50%)}  #overlay.mobile span.sh-tooltip{display:none}"]}),u})()},563:(L,T,l)=>{l.d(T,{h:()=>_});var d=l(4537);let _=(()=>{class C{constructor(u){this._elementRef=u,this.showToolTip=!0,this.margin=5,this._position="above"}click(){setTimeout(()=>{this.shToolTipComponent.text=this.text,(!this.text||!Object.values(this._elementRef.nativeElement.getBoundingClientRect().toJSON()).find(u=>0!=u))&&(this.shToolTipComponent.show=!1)})}show(){!this.text||(this.shToolTipComponent.text=this.text,this.shToolTipPosition?(this._position=this.shToolTipPosition,this.shToolTipComponent.position=this._position):this.shToolTipComponent.position?this._position=this.shToolTipComponent.position:this.shToolTipComponent.position=this._position,this.shToolTipComponent.pos=this._getPos(),this.shToolTipComponent.show=!0)}hide(){this.shToolTipComponent.text=void 0,this.shToolTipComponent.show=!1}_getPos(){let u=this._elementRef.nativeElement.getBoundingClientRect(),p={left:u.left,top:u.top,width:u.width,height:u.height},m=document.getElementById("overlay").getBoundingClientRect();p.left-=m.left,p.top-=m.top;let h=this.shToolTipComponent.ref.nativeElement,f={left:0,top:0};return"above"==this._position||"below"==this._position?(f.left=p.left+p.width/2,f.left-h.offsetWidth/2<0?f.left=h.offsetWidth/2:f.left+h.offsetWidth/2>document.body.clientWidth&&(f.left=document.body.clientWidth-h.offsetWidth/2),"above"==this._position?(f.top=p.top-this.margin,f.top-h.offsetHeight<0&&(f.top=h.offsetHeight)):"below"==this._position&&(f.top=p.top+p.height+this.margin,f.top+h.offsetHeight>document.body.clientHeight&&(f.top=document.body.clientHeight-h.offsetHeight))):("before"==this._position||"after"==this._position)&&(f.top=p.top+p.height/2,f.top-h.offsetHeight/2<0?f.top=h.offsetHeight/2:f.top+h.offsetHeight/2>document.body.clientHeight&&(f.top=document.body.clientHeight-h.offsetHeight/2),"before"==this._position?(f.left=p.left-this.margin,f.left-h.offsetWidth<0&&(f.left=h.offsetWidth)):"after"==this._position&&(f.left=p.left+p.width+this.margin,f.left+h.offsetWidth>document.body.clientWidth&&(f.left=document.body.clientWidth-h.offsetWidth))),f}}return C.\u0275fac=function(u){return new(u||C)(d.Y36(d.SBq))},C.\u0275dir=d.lG2({type:C,selectors:[["","shToolTip",""]],hostBindings:function(u,p){1&u&&d.NdJ("click",function(){return p.click()})("mouseenter",function(){return p.show()})("mouseleave",function(){return p.hide()})},inputs:{showToolTip:"showToolTip",text:["shToolTip","text"],shToolTipComponent:"shToolTipComponent",shToolTipPosition:"shToolTipPosition"}}),C})()},9488:(L,T,l)=>{l.d(T,{y:()=>C});var d=l(8692),_=l(4537);let C=(()=>{class v{}return v.\u0275fac=function(p){return new(p||v)},v.\u0275mod=_.oAB({type:v}),v.\u0275inj=_.cJS({imports:[d.ez]}),v})()},6047:(L,T,l)=>{l.r(T),l.d(T,{OtherVideocallModule:()=>Pt});var d={};l.r(d),l.d(d,{Decoder:()=>W,Encoder:()=>rt,PacketType:()=>a,protocol:()=>st});var _=l(8692),C=l(4507),v=l(6031),u=l(9638),p=l(9488),m=l(92),h=l(8041);const f=JSON.parse('{"widget":"OtherVideocallComponent","options":[{"key":"share-text","label":"Share text","type":"text","category":"content","value":{"en":"Share link:"},"font":{"family":"Exo","align":"left","size":14,"line_height":21,"italic":false,"bold":false,"underline":false,"color":""}},{"key":"size","label":"Size","type":"slider","category":"appearance","help":"px","max":500,"min":0,"value":136},{"key":"border_radius","label":"Border radius","type":"border-radius","category":"appearance","value":{"topLeft":20,"topRight":20,"bottomLeft":20,"bottomRight":20}},{"key":"margin","label":"Margin","type":"slider","category":"appearance","help":"px","value":10},{"key":"area","label":"Area","areas":["top","bottom","left","right","top-left","top-right","bottom-left","bottom-right"],"type":"area","category":"appearance","value":"top-left"},{"key":"vertical","label":"Vertical","type":"toggle","category":"appearance","value":false},{"key":"colors","type":"color-bundle","category":"colors","value":{"common_color":false,"background":{"type":"native","color":"rgb(241 196 15)"},"active_color":{"type":"native","color":"rgb(234,67,53)"},"text_color":{"color":"rgb(0,0,0)"}}},{"key":"styles","label":"Styles","type":"css","category":"styles","value":""}]}'),x=Object.create(null);x.open="0",x.close="1",x.ping="2",x.pong="3",x.message="4",x.upgrade="5",x.noop="6";const V=Object.create(null);Object.keys(x).forEach(i=>{V[x[i]]=i});const be={type:"error",data:"parser error"},Te="function"==typeof Blob||typeof Blob<"u"&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),xe="function"==typeof ArrayBuffer,G=(i,t)=>{const e=new FileReader;return e.onload=function(){const n=e.result.split(",")[1];t("b"+n)},e.readAsDataURL(i)},j=({type:i,data:t},e,n)=>Te&&t instanceof Blob?e?n(t):G(t,n):xe&&(t instanceof ArrayBuffer||(i=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(i):i&&i.buffer instanceof ArrayBuffer)(t))?e?n(t):G(new Blob([t]),n):n(x[i]+(t||"")),M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",R=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let i=0;i<M.length;i++)R[M.charCodeAt(i)]=i;const Me="function"==typeof ArrayBuffer,Ee=(i,t)=>{if(Me){const e=(i=>{let n,r,c,y,w,t=.75*i.length,e=i.length,s=0;"="===i[i.length-1]&&(t--,"="===i[i.length-2]&&t--);const N=new ArrayBuffer(t),E=new Uint8Array(N);for(n=0;n<e;n+=4)r=R[i.charCodeAt(n)],c=R[i.charCodeAt(n+1)],y=R[i.charCodeAt(n+2)],w=R[i.charCodeAt(n+3)],E[s++]=r<<2|c>>4,E[s++]=(15&c)<<4|y>>2,E[s++]=(3&y)<<6|63&w;return N})(i);return X(e,t)}return{base64:!0,data:i}},X=(i,t)=>"blob"===t&&i instanceof ArrayBuffer?new Blob([i]):i,$=(i,t)=>{if("string"!=typeof i)return{type:"message",data:X(i,t)};const e=i.charAt(0);return"b"===e?{type:"message",data:Ee(i.substring(1),t)}:V[e]?i.length>1?{type:V[e],data:i.substring(1)}:{type:V[e]}:be},ee=String.fromCharCode(30);function g(i){if(i)return function Se(i){for(var t in g.prototype)i[t]=g.prototype[t];return i}(i)}g.prototype.on=g.prototype.addEventListener=function(i,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+i]=this._callbacks["$"+i]||[]).push(t),this},g.prototype.once=function(i,t){function e(){this.off(i,e),t.apply(this,arguments)}return e.fn=t,this.on(i,e),this},g.prototype.off=g.prototype.removeListener=g.prototype.removeAllListeners=g.prototype.removeEventListener=function(i,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var e=this._callbacks["$"+i];if(!e)return this;if(1==arguments.length)return delete this._callbacks["$"+i],this;for(var n,s=0;s<e.length;s++)if((n=e[s])===t||n.fn===t){e.splice(s,1);break}return 0===e.length&&delete this._callbacks["$"+i],this},g.prototype.emitReserved=g.prototype.emit=function(i){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),e=this._callbacks["$"+i],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(e){n=0;for(var s=(e=e.slice(0)).length;n<s;++n)e[n].apply(this,t)}return this},g.prototype.listeners=function(i){return this._callbacks=this._callbacks||{},this._callbacks["$"+i]||[]},g.prototype.hasListeners=function(i){return!!this.listeners(i).length};const O=typeof self<"u"?self:typeof window<"u"?window:Function("return this")();function ne(i,...t){return t.reduce((e,n)=>(i.hasOwnProperty(n)&&(e[n]=i[n]),e),{})}const Ne=setTimeout,Be=clearTimeout;function H(i,t){t.useNativeTimers?(i.setTimeoutFn=Ne.bind(O),i.clearTimeoutFn=Be.bind(O)):(i.setTimeoutFn=setTimeout.bind(O),i.clearTimeoutFn=clearTimeout.bind(O))}function Ve(i){return"string"==typeof i?function He(i){let t=0,e=0;for(let n=0,s=i.length;n<s;n++)t=i.charCodeAt(n),t<128?e+=1:t<2048?e+=2:t<55296||t>=57344?e+=3:(n++,e+=4);return e}(i):Math.ceil(1.33*(i.byteLength||i.size))}class ze extends Error{constructor(t,e,n){super(t),this.description=e,this.context=n,this.type="TransportError"}}class ie extends g{constructor(t){super(),this.writable=!1,H(this,t),this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}onError(t,e,n){return super.emitReserved("error",new ze(t,e,n)),this}open(){return("closed"===this.readyState||""===this.readyState)&&(this.readyState="opening",this.doOpen()),this}close(){return("opening"===this.readyState||"open"===this.readyState)&&(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=$(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}}const oe="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),se={};let ce,re=0,k=0;function ae(i){let t="";do{t=oe[i%64]+t,i=Math.floor(i/64)}while(i>0);return t}function le(){const i=ae(+new Date);return i!==ce?(re=0,ce=i):i+"."+ae(re++)}for(;k<64;k++)se[oe[k]]=k;function he(i){let t="";for(let e in i)i.hasOwnProperty(e)&&(t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(i[e]));return t}let pe=!1;try{pe=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const De=pe;function fe(i){const t=i.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||De))return new XMLHttpRequest}catch{}if(!t)try{return new(O[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch{}}function Ue(){}const Je=null!=new fe({xdomain:!1}).responseType;let I=(()=>{class i extends g{constructor(e,n){super(),H(this,n),this.opts=n,this.method=n.method||"GET",this.uri=e,this.async=!1!==n.async,this.data=void 0!==n.data?n.data:null,this.create()}create(){const e=ne(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;const n=this.xhr=new fe(e);try{n.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let s in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(s)&&n.setRequestHeader(s,this.opts.extraHeaders[s])}}catch{}if("POST"===this.method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),n.onreadystatechange=()=>{4===n.readyState&&(200===n.status||1223===n.status?this.onLoad():this.setTimeoutFn(()=>{this.onError("number"==typeof n.status?n.status:0)},0))},n.send(this.data)}catch(s){return void this.setTimeoutFn(()=>{this.onError(s)},0)}typeof document<"u"&&(this.index=i.requestsCount++,i.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr>"u"||null===this.xhr)){if(this.xhr.onreadystatechange=Ue,e)try{this.xhr.abort()}catch{}typeof document<"u"&&delete i.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}return i.requestsCount=0,i.requests={},i})();function de(){for(let i in I.requests)I.requests.hasOwnProperty(i)&&I.requests[i].abort()}typeof document<"u"&&("function"==typeof attachEvent?attachEvent("onunload",de):"function"==typeof addEventListener&&addEventListener("onpagehide"in O?"pagehide":"unload",de,!1));const Ze="function"==typeof Promise&&"function"==typeof Promise.resolve?t=>Promise.resolve().then(t):(t,e)=>e(t,0),D=O.WebSocket||O.MozWebSocket,ue=typeof navigator<"u"&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),Ke={websocket:class Qe extends ie{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),e=this.opts.protocols,n=ue?{}:ne(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=ue?new D(t,e,n):e?new D(t,e):new D(t)}catch(s){return this.emitReserved("error",s)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const s=e===t.length-1;j(t[e],this.supportsBinary,r=>{try{this.ws.send(r)}catch{}s&&Ze(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{};const e=this.opts.secure?"wss":"ws";let n="";this.opts.port&&("wss"===e&&443!==Number(this.opts.port)||"ws"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=le()),this.supportsBinary||(t.b64=1);const s=he(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(s.length?"?"+s:"")}check(){return!!D}},polling:class Fe extends ie{constructor(t){if(super(t),this.polling=!1,typeof location<"u"){const n="https:"===location.protocol;let s=location.port;s||(s=n?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||s!==t.port,this.xs=t.secure!==n}this.supportsBinary=Je&&!(t&&t.forceBase64)}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this.polling||!this.writable){let n=0;this.polling&&(n++,this.once("pollComplete",function(){--n||e()})),this.writable||(n++,this.once("drain",function(){--n||e()}))}else e()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){((i,t)=>{const e=i.split(ee),n=[];for(let s=0;s<e.length;s++){const r=$(e[s],t);if(n.push(r),"error"===r.type)break}return n})(t,this.socket.binaryType).forEach(n=>{if("opening"===this.readyState&&"open"===n.type&&this.onOpen(),"close"===n.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)}),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const t=()=>{this.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}write(t){this.writable=!1,((i,t)=>{const e=i.length,n=new Array(e);let s=0;i.forEach((r,c)=>{j(r,!1,y=>{n[c]=y,++s===e&&t(n.join(ee))})})})(t,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let t=this.query||{};const e=this.opts.secure?"https":"http";let n="";!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=le()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.opts.port&&("https"===e&&443!==Number(this.opts.port)||"http"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port);const s=he(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(s.length?"?"+s:"")}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new I(this.uri(),t)}doWrite(t,e){const n=this.request({method:"POST",data:t});n.on("success",e),n.on("error",(s,r)=>{this.onError("xhr post error",s,r)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(e,n)=>{this.onError("xhr poll error",e,n)}),this.pollXhr=t}}},We=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Ye=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Z(i){const t=i,e=i.indexOf("["),n=i.indexOf("]");-1!=e&&-1!=n&&(i=i.substring(0,e)+i.substring(e,n).replace(/:/g,";")+i.substring(n,i.length));let s=We.exec(i||""),r={},c=14;for(;c--;)r[Ye[c]]=s[c]||"";return-1!=e&&-1!=n&&(r.source=t,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0),r.pathNames=function Ge(i,t){const n=t.replace(/\/{2,9}/g,"/").split("/");return("/"==t.substr(0,1)||0===t.length)&&n.splice(0,1),"/"==t.substr(t.length-1,1)&&n.splice(n.length-1,1),n}(0,r.path),r.queryKey=function je(i,t){const e={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,s,r){s&&(e[s]=r)}),e}(0,r.query),r}let me=(()=>{class i extends g{constructor(e,n={}){super(),e&&"object"==typeof e&&(n=e,e=null),e?(e=Z(e),n.hostname=e.host,n.secure="https"===e.protocol||"wss"===e.protocol,n.port=e.port,e.query&&(n.query=e.query)):n.host&&(n.hostname=Z(n.host).host),H(this,n),this.secure=null!=n.secure?n.secure:typeof location<"u"&&"https:"===location.protocol,n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=n.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},n),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"==typeof this.opts.query&&(this.opts.query=function Ie(i){let t={},e=i.split("&");for(let n=0,s=e.length;n<s;n++){let r=e[n].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const n=Object.assign({},this.opts.query);n.EIO=4,n.transport=e,this.id&&(n.sid=this.id);const s=Object.assign({},this.opts.transportOptions[e],this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new Ke[e](s)}open(){let e;if(this.opts.rememberUpgrade&&i.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch{return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",n=>this.onClose("transport close",n))}probe(e){let n=this.createTransport(e),s=!1;i.priorWebsocketSuccess=!1;const r=()=>{s||(n.send([{type:"ping",data:"probe"}]),n.once("packet",A=>{if(!s)if("pong"===A.type&&"probe"===A.data){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;i.priorWebsocketSuccess="websocket"===n.name,this.transport.pause(()=>{s||"closed"!==this.readyState&&(Ce(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const B=new Error("probe error");B.transport=n.name,this.emitReserved("upgradeError",B)}}))};function c(){s||(s=!0,Ce(),n.close(),n=null)}const y=A=>{const B=new Error("probe error: "+A);B.transport=n.name,c(),this.emitReserved("upgradeError",B)};function w(){y("transport closed")}function N(){y("socket closed")}function E(A){n&&A.name!==n.name&&c()}const Ce=()=>{n.removeListener("open",r),n.removeListener("error",y),n.removeListener("close",w),this.off("close",N),this.off("upgrading",E)};n.once("open",r),n.once("error",y),n.once("close",w),this.once("close",N),this.once("upgrading",E),n.open()}onOpen(){if(this.readyState="open",i.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){let e=0;const n=this.upgrades.length;for(;e<n;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const n=new Error("server error");n.code=e.data,this.onError(n);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let s=0;s<this.writeBuffer.length;s++){const r=this.writeBuffer[s].data;if(r&&(n+=Ve(r)),s>0&&n>this.maxPayload)return this.writeBuffer.slice(0,s);n+=2}return this.writeBuffer}write(e,n,s){return this.sendPacket("message",e,n,s),this}send(e,n,s){return this.sendPacket("message",e,n,s),this}sendPacket(e,n,s,r){if("function"==typeof n&&(r=n,n=void 0),"function"==typeof s&&(r=s,s=null),"closing"===this.readyState||"closed"===this.readyState)return;(s=s||{}).compress=!1!==s.compress;const c={type:e,data:n,options:s};this.emitReserved("packetCreate",c),this.writeBuffer.push(c),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),e()},s=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return("opening"===this.readyState||"open"===this.readyState)&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():e()}):this.upgrading?s():e()),this}onError(e){i.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,n){("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",e,n),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const n=[];let s=0;const r=e.length;for(;s<r;s++)~this.transports.indexOf(e[s])&&n.push(e[s]);return n}}return i.protocol=4,i})();const $e="function"==typeof ArrayBuffer,ge=Object.prototype.toString,tt="function"==typeof Blob||typeof Blob<"u"&&"[object BlobConstructor]"===ge.call(Blob),nt="function"==typeof File||typeof File<"u"&&"[object FileConstructor]"===ge.call(File);function q(i){return $e&&(i instanceof ArrayBuffer||(i=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(i):i.buffer instanceof ArrayBuffer)(i))||tt&&i instanceof Blob||nt&&i instanceof File}function U(i,t){if(!i||"object"!=typeof i)return!1;if(Array.isArray(i)){for(let e=0,n=i.length;e<n;e++)if(U(i[e]))return!0;return!1}if(q(i))return!0;if(i.toJSON&&"function"==typeof i.toJSON&&1===arguments.length)return U(i.toJSON(),!0);for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e)&&U(i[e]))return!0;return!1}function it(i){const t=[],n=i;return n.data=Q(i.data,t),n.attachments=t.length,{packet:n,buffers:t}}function Q(i,t){if(!i)return i;if(q(i)){const e={_placeholder:!0,num:t.length};return t.push(i),e}if(Array.isArray(i)){const e=new Array(i.length);for(let n=0;n<i.length;n++)e[n]=Q(i[n],t);return e}if("object"==typeof i&&!(i instanceof Date)){const e={};for(const n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=Q(i[n],t));return e}return i}function ot(i,t){return i.data=K(i.data,t),i.attachments=void 0,i}function K(i,t){if(!i)return i;if(i&&!0===i._placeholder){if("number"==typeof i.num&&i.num>=0&&i.num<t.length)return t[i.num];throw new Error("illegal attachments")}if(Array.isArray(i))for(let e=0;e<i.length;e++)i[e]=K(i[e],t);else if("object"==typeof i)for(const e in i)Object.prototype.hasOwnProperty.call(i,e)&&(i[e]=K(i[e],t));return i}const st=5;var a=(()=>{return(i=a||(a={}))[i.CONNECT=0]="CONNECT",i[i.DISCONNECT=1]="DISCONNECT",i[i.EVENT=2]="EVENT",i[i.ACK=3]="ACK",i[i.CONNECT_ERROR=4]="CONNECT_ERROR",i[i.BINARY_EVENT=5]="BINARY_EVENT",i[i.BINARY_ACK=6]="BINARY_ACK",a;var i})();class rt{constructor(t){this.replacer=t}encode(t){return t.type!==a.EVENT&&t.type!==a.ACK||!U(t)?[this.encodeAsString(t)]:(t.type=t.type===a.EVENT?a.BINARY_EVENT:a.BINARY_ACK,this.encodeAsBinary(t))}encodeAsString(t){let e=""+t.type;return(t.type===a.BINARY_EVENT||t.type===a.BINARY_ACK)&&(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=it(t),n=this.encodeAsString(e.packet),s=e.buffers;return s.unshift(n),s}}class W extends g{constructor(t){super(),this.reviver=t}add(t){let e;if("string"==typeof t){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t),e.type===a.BINARY_EVENT||e.type===a.BINARY_ACK?(this.reconstructor=new ct(e),0===e.attachments&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else{if(!q(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e))}}decodeString(t){let e=0;const n={type:Number(t.charAt(0))};if(void 0===a[n.type])throw new Error("unknown packet type "+n.type);if(n.type===a.BINARY_EVENT||n.type===a.BINARY_ACK){const r=e+1;for(;"-"!==t.charAt(++e)&&e!=t.length;);const c=t.substring(r,e);if(c!=Number(c)||"-"!==t.charAt(e))throw new Error("Illegal attachments");n.attachments=Number(c)}if("/"===t.charAt(e+1)){const r=e+1;for(;++e&&","!==t.charAt(e)&&e!==t.length;);n.nsp=t.substring(r,e)}else n.nsp="/";const s=t.charAt(e+1);if(""!==s&&Number(s)==s){const r=e+1;for(;++e;){const c=t.charAt(e);if(null==c||Number(c)!=c){--e;break}if(e===t.length)break}n.id=Number(t.substring(r,e+1))}if(t.charAt(++e)){const r=this.tryParse(t.substr(e));if(!W.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return n}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,e){switch(t){case a.CONNECT:return"object"==typeof e;case a.DISCONNECT:return void 0===e;case a.CONNECT_ERROR:return"string"==typeof e||"object"==typeof e;case a.EVENT:case a.BINARY_EVENT:return Array.isArray(e)&&e.length>0;case a.ACK:case a.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}class ct{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const e=ot(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function b(i,t,e){return i.on(t,e),function(){i.off(t,e)}}const at=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class ye extends g{constructor(t,e,n){super(),this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,n&&n.auth&&(this.auth=n.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[b(t,"open",this.onopen.bind(this)),b(t,"packet",this.onpacket.bind(this)),b(t,"error",this.onerror.bind(this)),b(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){if(at.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');e.unshift(t);const n={type:a.EVENT,data:e,options:{}};if(n.options.compress=!1!==this.flags.compress,"function"==typeof e[e.length-1]){const c=this.ids++,y=e.pop();this._registerAckCallback(c,y),n.id=c}return this.flags.volatile&&(!(this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable)||!this.connected)||(this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n)),this.flags={},this}_registerAckCallback(t,e){const n=this.flags.timeout;if(void 0===n)return void(this.acks[t]=e);const s=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let r=0;r<this.sendBuffer.length;r++)this.sendBuffer[r].id===t&&this.sendBuffer.splice(r,1);e.call(this,new Error("operation has timed out"))},n);this.acks[t]=(...r)=>{this.io.clearTimeoutFn(s),e.apply(this,[null,...r])}}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){"function"==typeof this.auth?this.auth(t=>{this.packet({type:a.CONNECT,data:t})}):this.packet({type:a.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case a.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case a.EVENT:case a.BINARY_EVENT:this.onevent(t);break;case a.ACK:case a.BINARY_ACK:this.onack(t);break;case a.DISCONNECT:this.ondisconnect();break;case a.CONNECT_ERROR:this.destroy();const n=new Error(t.data.message);n.data=t.data.data,this.emitReserved("connect_error",n)}}onevent(t){const e=t.data||[];null!=t.id&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const n of e)n.apply(this,t)}super.emit.apply(this,t)}ack(t){const e=this;let n=!1;return function(...s){n||(n=!0,e.packet({type:a.ACK,id:t,data:s}))}}onack(t){const e=this.acks[t.id];"function"==typeof e&&(e.apply(this,t.data),delete this.acks[t.id])}onconnect(t){this.id=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:a.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const n of e)n.apply(this,t.data)}}}function P(i){this.ms=(i=i||{}).min||100,this.max=i.max||1e4,this.factor=i.factor||2,this.jitter=i.jitter>0&&i.jitter<=1?i.jitter:0,this.attempts=0}P.prototype.duration=function(){var i=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),e=Math.floor(t*this.jitter*i);i=0==(1&Math.floor(10*t))?i-e:i+e}return 0|Math.min(i,this.max)},P.prototype.reset=function(){this.attempts=0},P.prototype.setMin=function(i){this.ms=i},P.prototype.setMax=function(i){this.max=i},P.prototype.setJitter=function(i){this.jitter=i};class Y extends g{constructor(t,e){var n;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.opts=e,H(this,e),this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=e.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new P({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout??2e4),this._readyState="closed",this.uri=t;const s=e.parser||d;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=!1!==e.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}randomizationFactor(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new me(this.uri,this.opts);const e=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const s=b(e,"open",function(){n.onopen(),t&&t()}),r=b(e,"error",c=>{n.cleanup(),n._readyState="closed",this.emitReserved("error",c),t?t(c):n.maybeReconnectOnOpen()});if(!1!==this._timeout){const c=this._timeout;0===c&&s();const y=this.setTimeoutFn(()=>{s(),e.close(),e.emit("error",new Error("timeout"))},c);this.opts.autoUnref&&y.unref(),this.subs.push(function(){clearTimeout(y)})}return this.subs.push(s),this.subs.push(r),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(b(t,"ping",this.onping.bind(this)),b(t,"data",this.ondata.bind(this)),b(t,"error",this.onerror.bind(this)),b(t,"close",this.onclose.bind(this)),b(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch{this.onclose("parse error")}}ondecoded(t){this.emitReserved("packet",t)}onerror(t){this.emitReserved("error",t)}socket(t,e){let n=this.nsps[t];return n||(n=new ye(this,t,e),this.nsps[t]=n),n}_destroy(t){const e=Object.keys(this.nsps);for(const n of e)if(this.nsps[n].active)return;this._close()}_packet(t){const e=this.encoder.encode(t);for(let n=0;n<e.length;n++)this.engine.write(e[n],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t,e){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(s=>{s?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",s)):t.onreconnect()}))},e);this.opts.autoUnref&&n.unref(),this.subs.push(function(){clearTimeout(n)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const S={};function J(i,t){"object"==typeof i&&(t=i,i=void 0);const e=function Xe(i,t="",e){let n=i;e=e||typeof location<"u"&&location,null==i&&(i=e.protocol+"//"+e.host),"string"==typeof i&&("/"===i.charAt(0)&&(i="/"===i.charAt(1)?e.protocol+i:e.host+i),/^(https?|wss?):\/\//.test(i)||(i=typeof e<"u"?e.protocol+"//"+i:"https://"+i),n=Z(i)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const r=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+r+":"+n.port+t,n.href=n.protocol+"://"+r+(e&&e.port===n.port?"":":"+n.port),n}(i,(t=t||{}).path||"/socket.io"),n=e.source,s=e.id;let w;return t.forceNew||t["force new connection"]||!1===t.multiplex||S[s]&&e.path in S[s].nsps?w=new Y(n,t):(S[s]||(S[s]=new Y(n,t)),w=S[s]),e.query&&!t.query&&(t.query=e.queryKey),w.socket(e.path,t)}Object.assign(J,{Manager:Y,Socket:ye,io:J,connect:J});var lt=l(945),o=l(4537),ht=l(2001),_e=l(354),pt=l(7591),ve=l(563);const ft=["video"];function dt(i,t){if(1&i){const e=o.EpF();o.TgZ(0,"button",7),o.NdJ("click",function(){o.CHM(e);const s=o.oxw();return o.KtG(s.muteUser())}),o._UZ(1,"sh-icon",8),o.qZA()}if(2&i){const e=o.oxw();o.Q6J("shToolTip",e.muted?"Unmute":"Mute")("shToolTipComponent",e.tooltip),o.xp6(1),o.Q6J("icon",e.muted?e.icons[1]:e.icons[0])}}function ut(i,t){if(1&i&&o._UZ(0,"sh-icon",8),2&i){const e=o.oxw();o.Q6J("icon",e.icons[2])}}function mt(i,t){if(1&i&&o._UZ(0,"sh-icon",8),2&i){const e=o.oxw();o.Q6J("icon",e.icons[1])}}let gt=(()=>{class i{constructor(){this.local=!1,this.icons=[{prefix:"fas",iconName:"microphone-lines",icon:[384,512,[127897,"microphone-alt"],"f3c9","M192 352c53.03 0 96-42.97 96-96h-80C199.2 256 192 248.8 192 240S199.2 224 208 224H288V192h-80C199.2 192 192 184.8 192 176S199.2 160 208 160H288V127.1h-80c-8.836 0-16-7.164-16-16s7.164-16 16-16L288 96c0-53.03-42.97-96-96-96s-96 42.97-96 96v160C96 309 138.1 352 192 352zM344 192C330.7 192 320 202.7 320 215.1V256c0 73.33-61.97 132.4-136.3 127.7c-66.08-4.169-119.7-66.59-119.7-132.8L64 215.1C64 202.7 53.25 192 40 192S16 202.7 16 215.1v32.15c0 89.66 63.97 169.6 152 181.7V464H128c-18.19 0-32.84 15.18-31.96 33.57C96.43 505.8 103.8 512 112 512h160c8.222 0 15.57-6.216 15.96-14.43C288.8 479.2 274.2 464 256 464h-40v-33.77C301.7 418.5 368 344.9 368 256V215.1C368 202.7 357.3 192 344 192z"]},{prefix:"fas",iconName:"microphone-lines-slash",icon:[640,512,["microphone-alt-slash"],"f539","M383.1 464l-39.1-.0001v-33.77c20.6-2.824 39.99-9.402 57.69-18.72l-43.26-33.91c-14.66 4.65-30.28 7.179-46.68 6.144C245.7 379.6 191.1 317.1 191.1 250.9v-3.777L143.1 209.5l.0001 38.61c0 89.65 63.97 169.6 151.1 181.7v34.15l-40 .0001c-17.67 0-31.1 14.33-31.1 31.1C223.1 504.8 231.2 512 239.1 512h159.1c8.838 0 15.1-7.164 15.1-15.1C415.1 478.3 401.7 464 383.1 464zM630.8 469.1l-159.3-124.9c15.37-25.94 24.53-55.91 24.53-88.21V216c0-13.25-10.75-24-23.1-24c-13.25 0-24 10.75-24 24l-.0001 39.1c0 21.12-5.557 40.77-14.77 58.24l-25.73-20.16c5.234-11.68 8.493-24.42 8.493-38.08l-57.07 .0006l-34.45-27c2.914-3.055 6.969-4.999 11.52-4.999h79.1V192L335.1 192c-8.836 0-15.1-7.164-15.1-15.1s7.164-16 15.1-16l79.1 .0013V128l-79.1-.0015c-8.836 0-15.1-7.164-15.1-15.1s7.164-15.1 15.1-15.1l80-.0003c0-54-44.56-97.57-98.93-95.95C264.5 1.614 223.1 47.45 223.1 100l.0006 50.23L38.81 5.111C34.41 1.673 29.19 0 24.03 0C16.91 0 9.84 3.158 5.121 9.189C-3.067 19.63-1.249 34.72 9.189 42.89l591.1 463.1c10.5 8.203 25.57 6.328 33.69-4.078C643.1 492.4 641.2 477.3 630.8 469.1z"]},{prefix:"fas",iconName:"display",icon:[576,512,[],"e163","M528 0h-480C21.5 0 0 21.5 0 48v320C0 394.5 21.5 416 48 416h192L224 464H152C138.8 464 128 474.8 128 488S138.8 512 152 512h272c13.25 0 24-10.75 24-24s-10.75-24-24-24H352L336 416h192c26.5 0 48-21.5 48-48v-320C576 21.5 554.5 0 528 0zM512 352H64V64h448V352z"]}],this.muted=!1}ngAfterViewInit(){let e=this.video?.nativeElement;!e||(e.muted=this.local,this.peer.stream.id&&(e.srcObject=this.peer.stream),e.addEventListener("loadedmetadata",()=>{e.pause(),setTimeout(()=>{e.play(),e.muted=this.local})}))}muteUser(){this.muted=!this.muted,this.peer.stream.getAudioTracks&&this.peer.stream.getAudioTracks().forEach(e=>{e.enabled=!this.muted})}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=o.Xpm({type:i,selectors:[["wdg-other-videocall-user"]],viewQuery:function(e,n){if(1&e&&o.Gf(ft,5),2&e){let s;o.iGM(s=o.CRH())&&(n.video=s.first)}},inputs:{peer:"peer",local:"local",tooltip:"tooltip",host:"host"},decls:8,vars:5,consts:[[1,"videocall-user-wrapper"],["muted","","playsinline",""],["video",""],[1,"user"],["mat-mini-fab","",3,"shToolTip","shToolTipComponent","click",4,"ngIf"],[1,"status"],[3,"icon",4,"ngIf"],["mat-mini-fab","",3,"shToolTip","shToolTipComponent","click"],[3,"icon"]],template:function(e,n){1&e&&(o.TgZ(0,"div",0),o._UZ(1,"video",1,2),o.qZA(),o._UZ(3,"div",3),o.YNc(4,dt,2,3,"button",4),o.TgZ(5,"div",5),o.YNc(6,ut,1,1,"sh-icon",6),o.YNc(7,mt,1,1,"sh-icon",6),o.qZA()),2&e&&(o.xp6(3),o.Udp("opacity",n.peer.volumeActive?1:0),o.xp6(1),o.Q6J("ngIf",!n.local),o.xp6(2),o.Q6J("ngIf",n.host==n.peer.peer),o.xp6(1),o.Q6J("ngIf",n.muted))},dependencies:[_.O5,_e.o,u.lW,ve.h],styles:['[_nghost-%COMP%]{--border-size: 2px;position:relative;box-sizing:border-box;padding:var(--border-size)}[_nghost-%COMP%]:after{content:"";display:block;padding-bottom:100%}[_nghost-%COMP%]:hover   button[_ngcontent-%COMP%]{opacity:1}[_nghost-%COMP%]   button[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;margin:2px;transform:translate(-50%,-50%);opacity:0;color:var(--text-color);background:var(--background)}[_nghost-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--active-color)}.videocall-user-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;overflow:hidden;-webkit-mask-image:-webkit-radial-gradient(white,black);position:absolute;width:100%;height:100%;border-radius:inherit}.videocall-user-wrapper[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;background-color:#000;transform:rotateY(180deg)}.user[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:inherit;border:var(--border-size) solid #2ecc71}.status[_ngcontent-%COMP%]{position:absolute;gap:5px;display:flex;bottom:0;right:0;margin:5px;color:#fff}']}),i})();var yt=l(7239);function _t(i,t){if(1&i&&(o._UZ(0,"code",5),o.ALo(1,"safe")),2&i){const e=o.oxw();o.Q6J("innerHTML",o.xi3(1,1,e.styles,"html"),o.oJD)}}function vt(i,t){if(1&i&&o._UZ(0,"wdg-other-videocall-user",12),2&i){const e=o.oxw(3);o.Q6J("peer",e.myPeer)("local",!0)("host",e.hostPeer)}}function Ct(i,t){if(1&i&&o._UZ(0,"wdg-other-videocall-user",14),2&i){const e=o.oxw().$implicit,n=o.oxw(3),s=o.MAs(4);o.Q6J("peer",e)("host",n.hostPeer)("tooltip",s)}}function bt(i,t){if(1&i&&(o.ynx(0),o.YNc(1,Ct,1,3,"wdg-other-videocall-user",13),o.BQk()),2&i){const e=t.$implicit;o.xp6(1),o.Q6J("ngIf",e.stream)}}function Tt(i,t){if(1&i&&(o.TgZ(0,"div",9),o.YNc(1,vt,1,3,"wdg-other-videocall-user",10),o.YNc(2,bt,2,1,"ng-container",11),o.qZA()),2&i){const e=o.oxw(2);o.xp6(1),o.Q6J("ngIf",e.myPeer.stream),o.xp6(1),o.Q6J("ngForOf",e.peerConnections)}}function xt(i,t){if(1&i){const e=o.EpF();o.TgZ(0,"button",15),o.NdJ("click",function(){o.CHM(e);const s=o.oxw(2);return o.KtG(s.connect())}),o._UZ(1,"sh-icon",16),o.qZA()}if(2&i){const e=o.oxw(2),n=o.MAs(4);o.Q6J("disabled",!e.peerJsReady)("shToolTipComponent",n),o.xp6(1),o.Q6J("icon",e.icons[0])}}function wt(i,t){if(1&i){const e=o.EpF();o.ynx(0),o.TgZ(1,"div",17)(2,"button",18),o.NdJ("click",function(){o.CHM(e);const s=o.oxw(2);return o.KtG(s.toggleCamera())}),o._UZ(3,"sh-icon",16),o.qZA(),o.TgZ(4,"button",18),o.NdJ("click",function(){o.CHM(e);const s=o.oxw(2);return o.KtG(s.toggleMicrophone())}),o._UZ(5,"sh-icon",16),o.qZA(),o.TgZ(6,"button",19),o.NdJ("click",function(){o.CHM(e);const s=o.oxw(2);return o.KtG(s.toggleHost())}),o._UZ(7,"sh-icon",16),o.qZA(),o.TgZ(8,"button",20),o.NdJ("click",function(){o.CHM(e);const s=o.oxw(2);return o.KtG(s.shareToggle())}),o._UZ(9,"sh-icon",16),o.qZA(),o.TgZ(10,"button",21),o.NdJ("click",function(){o.CHM(e);const s=o.oxw(2);return o.KtG(s.disconnect())}),o._UZ(11,"sh-icon",16),o.qZA(),o.TgZ(12,"button",22),o.NdJ("click",function(){o.CHM(e);const s=o.oxw(2);return o.KtG(s.toggle())}),o._UZ(13,"sh-icon",16),o.qZA()(),o.BQk()}if(2&i){const e=o.oxw(2),n=o.MAs(4);o.xp6(2),o.ekj("active",!e.cameraOn),o.Q6J("shToolTip",e.cameraOn?"Turn off camera":"Turn on camera")("shToolTipComponent",n),o.xp6(1),o.Q6J("icon",e.cameraOn?e.icons[4]:e.icons[5]),o.xp6(1),o.ekj("active",!e.microphoneOn),o.Q6J("shToolTip",e.microphoneOn?"Mute":"Unmute")("shToolTipComponent",n),o.xp6(1),o.Q6J("icon",e.microphoneOn?e.icons[2]:e.icons[3]),o.xp6(1),o.ekj("active",e.isHost),o.Q6J("disabled",e.hostPeer&&!e.isHost)("shToolTip",e.isHost?"Stop hosting":"Host")("shToolTipComponent",n),o.xp6(1),o.Q6J("icon",e.isHost?e.icons[7]:e.icons[6]),o.xp6(1),o.Q6J("shToolTipComponent",n),o.xp6(1),o.Q6J("icon",e.icons[9]),o.xp6(1),o.Q6J("shToolTipComponent",n),o.xp6(1),o.Q6J("icon",e.icons[1]),o.xp6(1),o.Q6J("shToolTipComponent",n),o.xp6(1),o.Q6J("icon",e.minimized?e.icons[0]:e.icons[8])}}function Ot(i,t){if(1&i&&(o.TgZ(0,"div",6),o.YNc(1,Tt,3,2,"div",7),o.YNc(2,xt,2,3,"button",8),o.YNc(3,wt,14,22,"ng-container",2),o.qZA()),2&i){const e=o.oxw();o.ekj("vertical",e.options.vertical.value)("minimized",e.minimized),o.Q6J("ngClass",e.options.area.value),o.xp6(1),o.Q6J("ngIf",e.myPeer),o.xp6(1),o.Q6J("ngIf",!e.connected),o.xp6(1),o.Q6J("ngIf",e.connected)}}function kt(i,t){if(1&i){const e=o.EpF();o.ynx(0),o.TgZ(1,"div",23),o.NdJ("click",function(){o.CHM(e);const s=o.oxw();return o.KtG(s.shareToggle())}),o.qZA(),o.TgZ(2,"div",24)(3,"label"),o._uU(4),o.qZA(),o.TgZ(5,"div",25)(6,"input",26,27),o.NdJ("ngModelChange",function(s){o.CHM(e);const r=o.oxw();return o.KtG(r.shareLink=s)})("click",function(s){o.CHM(e);const r=o.oxw();return o.KtG(r.shareCopy(s.target))}),o.qZA(),o.TgZ(8,"button",28),o.NdJ("click",function(){o.CHM(e);const s=o.MAs(7),r=o.oxw();return o.KtG(r.shareCopy(s))}),o._UZ(9,"sh-icon",16),o.qZA()()(),o.TgZ(10,"div",29),o._uU(11," Copied to clipboard "),o.qZA(),o.BQk()}if(2&i){const e=o.oxw();o.xp6(4),o.Oqu(e.i18n.t(e.options.share_text.value)),o.xp6(2),o.Q6J("ngModel",e.shareLink),o.xp6(3),o.Q6J("icon",e.icons[10]),o.xp6(1),o.Udp("visibility",e.showNotification?"visible":"hidden")}}let Mt=(()=>{class i extends h.P{constructor(e,n){super(e),this.viewerService=n,this.default_options=f,this.peerJsReady=!1,this.icons=[{prefix:"fas",iconName:"video-plus",icon:[576,512,[],"f4e1","M336 64h-288C21.49 64 0 85.49 0 112v288C0 426.5 21.49 448 48 448h288c26.51 0 48-21.49 48-48v-288C384 85.49 362.5 64 336 64zM272 279.1H215.1v56C215.1 349.3 205.3 360 192 360c-13.27 0-23.1-10.74-23.1-23.1V279.1H111.1C98.73 279.1 88 269.3 88 256c0-13.26 10.74-23.1 23.1-23.1H168V175.1C168 162.7 178.7 152 192 152s23.1 10.74 23.1 23.1V232H272C285.3 232 296 242.7 296 256S285.3 279.1 272 279.1zM525.6 101.7L416 177.3v157.4l109.6 75.49C546.8 424.8 576 409.9 576 384.4V127.5C576 102.1 546.9 87.13 525.6 101.7z"]},{prefix:"fas",iconName:"phone-hangup",icon:[640,512,[],"e225","M635.4 293.6l-52.73 84.25c-7.631 12.2-23.09 17.35-36.63 11.98l-105.4-42.1c-12.45-4.925-20.14-17.65-18.71-30.87l6.64-66.46C358.3 226.5 281.8 226.5 211.6 250.4l6.621 66.51c1.338 13.27-6.28 25.86-18.67 30.85l-105.5 42.13c-13.6 5.307-29.04 .2437-36.72-12.04l-52.71-84.22C-2.861 281.8-1.118 266.5 8.85 256.5C180.4 85.16 459.6 85.17 631.1 256.5C641.1 266.5 642.9 281.8 635.4 293.6z"]},{prefix:"fas",iconName:"microphone-lines",icon:[384,512,[127897,"microphone-alt"],"f3c9","M192 352c53.03 0 96-42.97 96-96h-80C199.2 256 192 248.8 192 240S199.2 224 208 224H288V192h-80C199.2 192 192 184.8 192 176S199.2 160 208 160H288V127.1h-80c-8.836 0-16-7.164-16-16s7.164-16 16-16L288 96c0-53.03-42.97-96-96-96s-96 42.97-96 96v160C96 309 138.1 352 192 352zM344 192C330.7 192 320 202.7 320 215.1V256c0 73.33-61.97 132.4-136.3 127.7c-66.08-4.169-119.7-66.59-119.7-132.8L64 215.1C64 202.7 53.25 192 40 192S16 202.7 16 215.1v32.15c0 89.66 63.97 169.6 152 181.7V464H128c-18.19 0-32.84 15.18-31.96 33.57C96.43 505.8 103.8 512 112 512h160c8.222 0 15.57-6.216 15.96-14.43C288.8 479.2 274.2 464 256 464h-40v-33.77C301.7 418.5 368 344.9 368 256V215.1C368 202.7 357.3 192 344 192z"]},{prefix:"fas",iconName:"microphone-lines-slash",icon:[640,512,["microphone-alt-slash"],"f539","M383.1 464l-39.1-.0001v-33.77c20.6-2.824 39.99-9.402 57.69-18.72l-43.26-33.91c-14.66 4.65-30.28 7.179-46.68 6.144C245.7 379.6 191.1 317.1 191.1 250.9v-3.777L143.1 209.5l.0001 38.61c0 89.65 63.97 169.6 151.1 181.7v34.15l-40 .0001c-17.67 0-31.1 14.33-31.1 31.1C223.1 504.8 231.2 512 239.1 512h159.1c8.838 0 15.1-7.164 15.1-15.1C415.1 478.3 401.7 464 383.1 464zM630.8 469.1l-159.3-124.9c15.37-25.94 24.53-55.91 24.53-88.21V216c0-13.25-10.75-24-23.1-24c-13.25 0-24 10.75-24 24l-.0001 39.1c0 21.12-5.557 40.77-14.77 58.24l-25.73-20.16c5.234-11.68 8.493-24.42 8.493-38.08l-57.07 .0006l-34.45-27c2.914-3.055 6.969-4.999 11.52-4.999h79.1V192L335.1 192c-8.836 0-15.1-7.164-15.1-15.1s7.164-16 15.1-16l79.1 .0013V128l-79.1-.0015c-8.836 0-15.1-7.164-15.1-15.1s7.164-15.1 15.1-15.1l80-.0003c0-54-44.56-97.57-98.93-95.95C264.5 1.614 223.1 47.45 223.1 100l.0006 50.23L38.81 5.111C34.41 1.673 29.19 0 24.03 0C16.91 0 9.84 3.158 5.121 9.189C-3.067 19.63-1.249 34.72 9.189 42.89l591.1 463.1c10.5 8.203 25.57 6.328 33.69-4.078C643.1 492.4 641.2 477.3 630.8 469.1z"]},{prefix:"fas",iconName:"camera-web",icon:[448,512,["webcam"],"f832","M400.9 438.6l-49.12-30.75C409.9 367.4 448 300.3 448 224c0-123.8-100.4-224-224-224c-123.8 0-224 100.3-224 224c0 76.25 38.13 143.4 96.13 183.9L47 438.6C37.63 444.5 32 454.8 32 465.8v14.25c0 17.62 14.48 31.1 32.11 31.1L384 512c17.62 0 32-14.38 32-32V465.8C416 454.8 410.3 444.5 400.9 438.6zM224 384c-88.37 0-160.1-71.62-160.1-159.1s71.63-160 159.1-160s160 71.62 160 160S312.3 384 224 384zM224 96C153.4 96 95.92 153.2 95.92 224s57.38 128 128 128c70.75 0 128-57.25 128-128C351.9 153.4 294.6 96 224 96zM223.9 176c-26.5 0-47.87 21.5-48 48c0 8.875-7.125 16-16 16c-8.75 0-16-7.125-16-16c.125-44.12 35.92-80 80.04-80c8.875 0 15.96 7.125 15.96 16S232.8 176 223.9 176z"]},{prefix:"fas",iconName:"camera-web-slash",icon:[640,512,["webcam-slash"],"f833","M319.1 383.1c-88.37 0-160.1-71.63-160.1-159.1c0-.6406 .1816-1.234 .1895-1.871L101.3 176C97.89 191.5 95.1 207.5 95.1 223.1c0 76.25 38.12 143.4 96.12 183.9l-49.12 30.75c-9.375 5.875-14.1 16.12-14.1 27.12v14.25c0 17.62 14.48 32 32.11 32l319.9-.0053c12.21 0 22.52-7.136 27.91-17.23l-148.4-116.3C346.8 381.7 333.7 383.1 319.1 383.1zM630.8 469.1l-135.7-106.4c30.42-38.12 48.92-86.1 48.92-138.7c0-123.7-100.4-223.1-223.1-223.1c-72.02 0-135.7 34.24-176.6 87.04L38.81 5.113C34.41 1.676 29.19 .0042 24.03 .0042c-7.125 0-14.19 3.156-18.91 9.187c-8.187 10.44-6.37 25.53 4.068 33.7l591.1 463.1c10.5 8.203 25.57 6.328 33.69-4.078C643.1 492.4 641.3 477.3 630.8 469.1zM319.9 175.1c-15.75 0-29.04 8.086-37.72 19.84l-25.66-20.11c14.55-19.23 37.47-31.72 63.42-31.72c8.875 0 15.96 7.124 15.96 15.1S328.7 175.1 319.9 175.1zM444.6 323.2L419.4 303.4c17.62-21.78 28.5-49.16 28.5-79.41c0-70.62-57.29-127.1-127.9-127.1c-41.28 0-77.63 19.93-100.9 50.38L193.9 126.6C223 88.71 268.3 63.1 319.9 63.1c88.37 0 159.1 71.62 159.1 159.1C479.9 261.7 466.5 295.9 444.6 323.2z"]},{prefix:"fas",iconName:"display",icon:[576,512,[],"e163","M528 0h-480C21.5 0 0 21.5 0 48v320C0 394.5 21.5 416 48 416h192L224 464H152C138.8 464 128 474.8 128 488S138.8 512 152 512h272c13.25 0 24-10.75 24-24s-10.75-24-24-24H352L336 416h192c26.5 0 48-21.5 48-48v-320C576 21.5 554.5 0 528 0zM512 352H64V64h448V352z"]},{prefix:"fas",iconName:"display-slash",icon:[640,512,["desktop-slash"],"e2fa","M455.1 464h-72l-16-48h39.99l-81.65-64H95.1L95.1 171.5L31.1 121.3V368c0 26.5 21.5 48 47.1 48h191.1l-16 48H183.1c-13.25 0-24 10.75-24 24s10.75 24 24 24h271.1c13.25 0 24-10.75 24-24S469.2 464 455.1 464zM630.8 469.1l-68.1-53.38c25.21-1.434 45.29-22.16 45.29-47.73v-320c0-26.5-21.5-48-48-48l-479.1 0c-12.3 0-23.41 4.77-31.9 12.38L38.81 5.113C34.41 1.676 29.19 0 24.03 0c-7.125 0-14.19 3.16-18.91 9.191c-8.187 10.44-6.37 25.53 4.068 33.7L601.2 506.9c10.5 8.203 25.57 6.328 33.69-4.078C643.1 492.4 641.2 477.3 630.8 469.1zM543.1 352h-62.59l-367.5-288h430L543.1 352z"]},{prefix:"fas",iconName:"xmark-large",icon:[448,512,[],"e59b","M393.4 41.37C405.9 28.88 426.1 28.88 438.6 41.37C451.1 53.87 451.1 74.13 438.6 86.63L269.3 255.1L438.6 425.4C451.1 437.9 451.1 458.1 438.6 470.6C426.1 483.1 405.9 483.1 393.4 470.6L223.1 301.3L54.63 470.6C42.13 483.1 21.87 483.1 9.372 470.6C-3.124 458.1-3.124 437.9 9.372 425.4L178.7 255.1L9.372 86.63C-3.124 74.13-3.124 53.87 9.372 41.37C21.87 28.88 42.13 28.88 54.63 41.37L223.1 210.7L393.4 41.37z"]},{prefix:"far",iconName:"share",icon:[512,512,["arrow-turn-right","mail-forward"],"f064","M152 184h271.5l-127.2-109.8c-10.03-8.656-11.12-23.81-2.469-33.84c8.688-10.06 23.85-11.21 33.85-2.487l176 151.1C508.1 194.4 512 201 512 208c0 6.968-3.029 13.58-8.31 18.14l-176 151.1c-4.531 3.937-10.13 5.847-15.69 5.847c-6.719 0-13.41-2.812-18.16-8.312c-8.656-10.03-7.562-25.19 2.469-33.84l127.2-109.8H152c-57.34 0-104 46.65-104 103.1v119.1C48 469.3 37.25 480 24 480S0 469.3 0 456v-119.1C0 252.2 68.19 184 152 184z"]},{prefix:"fal",iconName:"copy",icon:[512,512,[],"f0c5","M272 416C263.2 416 256 423.2 256 432V448c0 17.67-14.33 32-32 32H64c-17.67 0-32-14.33-32-32V192c0-17.67 14.33-32 32-32h112C184.8 160 192 152.8 192 144C192 135.2 184.8 128 176 128H63.99c-35.35 0-64 28.65-64 64l.0098 256C0 483.3 28.65 512 64 512h160c35.35 0 64-28.65 64-64v-16C288 423.2 280.8 416 272 416zM502.6 86.63l-77.25-77.25C419.4 3.371 411.2 0 402.7 0H288C252.7 0 224 28.65 224 64v256c0 35.35 28.65 64 64 64h160c35.35 0 64-28.65 64-64V109.3C512 100.8 508.6 92.63 502.6 86.63zM416 45.25L466.7 96H416V45.25zM480 320c0 17.67-14.33 32-32 32h-160c-17.67 0-32-14.33-32-32V64c0-17.67 14.33-32 32-32h96l.0026 64c0 17.67 14.33 32 32 32H480V320z"]}],this.peerConnections=[],this.showNotification=!1,this.cameraOn=!0,this.microphoneOn=!0,this.minimized=!1,this.shareActive=!1,this.shareLink="",(0,_.NF)(this.panoService.platformId)&&this.loadPeerjs()}loadPeerjs(){let e=document.createElement("script");e.type="text/javascript",e.src="https://unpkg.com/peerjs@1.4.7/dist/peerjs.min.js",e.onload=()=>{this.peerJsReady=!0},document.body.append(e)}get connected(){return this.socket?.connected}get editorMode(){return this.viewerService.editor}connect(){this.editorMode?(this.myPeer={peer:"test",stream:{},volumeActive:!1},this.socket={connected:!0,disconnect:function(){this.connected=!1}},this.peerConnections=[this.myPeer,this.myPeer]):navigator.mediaDevices.getUserMedia({video:!0,audio:{echoCancellation:!0}}).then(e=>{this.panoService.callRoom||(this.panoService.callRoom=(Math.random()+1).toString(36).substring(3),this.viewerService.viewerService.locationSubject.next()),this.peer=new Peer,this.socket=J("https://socket.gothru.co",{secure:!0,transports:["websocket"]}),this.peer.on("call",n=>{this._addPeer({peer:n.peer,call:n}),n.answer(e)}),this.peer.on("open",n=>{this.socket.emit("newUser",n,this.panoService.tourKey+this.panoService.callRoom),this.myPeer={peer:n,stream:e},this._setAnalyzer(this.myPeer),this.microMeterStart()}),this.peer.on("error",n=>{console.error(n.type)}),this.socket.on("userJoined",n=>{this._addPeer({peer:n,call:this.peer.call(n,this.myPeer?.stream)})}),this.socket.on("userDisconnect",n=>{this.peerConnections.find(s=>s.peer==n)?.call.close()}),this.socket.on("userHosting",n=>{this.hostPeer=n}),this.socket.on("hostChangingView",n=>{this.viewerService.goToPano(n.pano,n.position)}),this.socket.on("connect_error",n=>{console.log(n.message)})}).catch(e=>{console.error(e.message)})}disconnect(){this.socket.disconnect(),this.peer?.disconnect(),this.peer?.destroy(),this.cameraOn=!0,this.microphoneOn=!0,this.peerConnections=[],this._clearStream(this.myPeer),this.microMeterStop()}_addPeer(e){e.call.on("error",n=>{console.error(n)}),e.call.on("stream",n=>{e.stream||(e.stream=n,this._setAnalyzer(e))}),e.call.on("close",()=>{this._clearStream(e),this.peerConnections=this.peerConnections.filter(n=>n.peer!=e.peer)}),this.peerConnections.push(e)}_clearStream(e){e.stream?.id&&e.stream?.getTracks().forEach(n=>n.stop()),e.stream=void 0}toggleCamera(){this.cameraOn=!this.cameraOn,this.myPeer?.stream?.getVideoTracks&&this.myPeer.stream.getVideoTracks().forEach(e=>{e.enabled=this.cameraOn})}toggleMicrophone(){this.microphoneOn=!this.microphoneOn,this.myPeer?.stream?.getAudioTracks&&this.myPeer.stream.getAudioTracks().forEach(e=>{e.enabled=this.microphoneOn})}_setAnalyzer(e){const n=new AudioContext,s=n.createMediaStreamSource(e.stream),r=n.createAnalyser();r.fftSize=1024,r.smoothingTimeConstant=.8,s.connect(r),e.analyser=r}_detectActiveMicro(e){if(!e.analyser)return;const n=new Uint8Array(e.analyser.frequencyBinCount);e.analyser.getByteFrequencyData(n);let s=0;for(const c of n)s+=c;e.stream&&(e.volumeActive=Math.round(s/n.length)>10)}microMeterStart(){this.microMeter=(0,lt.F)(100).subscribe(()=>{this._detectActiveMicro(this.myPeer),this.peerConnections.forEach(e=>{this._detectActiveMicro(e)})})}microMeterStop(){this.microMeter?.unsubscribe()}ngOnDestroy(){this.microMeterStop()}get isHost(){return this.myPeer?.peer==this.hostPeer}toggleHost(){this.editorMode||(this.isHost?(this.hostPeer=void 0,this.socket.emit("stopHost"),this.viewerService.viewer.__events.viewChange.pop()):this.hostPeer||(this.hostPeer=this.myPeer.peer,this.socket.emit("startHost"),this.viewerService.viewer.__events.viewChange.push((e,n,s)=>{let r=this.viewerService.viewer.scene().view();this.socket.emit("changeView",{pano:this.viewerService.active.id,position:{theta:180*r.yaw()/Math.PI,phi:-1*r.pitch()*180/Math.PI,fov:180*r.fov()/Math.PI}})})))}toggle(){this.minimized=!this.minimized}onKeydownHandler(e){this.shareActive=!1}shareToggle(){this.shareActive=!this.shareActive,this.shareLink=document.location.href}shareCopy(e){let n=e;n.focus(),n.select(),document.execCommand("copy"),this.showNotification=!0,setTimeout(()=>{this.showNotification=!1},1e3)}addObservableFunc(){this.observableFunc.size=e=>this.onSizeChange(e),this.observableFunc.margin=e=>this.onMarginChange(e),this.observableFunc.border_radius=e=>this.onBorderRadiusChange(e),this.observableFunc.share_text_font=e=>this.onShareTextFontChange(e)}onSizeChange(e){this.elRef.nativeElement.style.setProperty("--size",e+"px")}onMarginChange(e){this.elRef.nativeElement.style.setProperty("--margin",e+"px")}onBorderRadiusChange(e){this.elRef.nativeElement.style.setProperty("--border-radius-top-left",e?e.topLeft+"px":null),this.elRef.nativeElement.style.setProperty("--border-radius-top-right",e?e.topRight+"px":null),this.elRef.nativeElement.style.setProperty("--border-radius-bottom-left",e?e.bottomLeft+"px":null),this.elRef.nativeElement.style.setProperty("--border-radius-bottom-right",e?e.bottomRight+"px":null)}onShareTextFontChange(e){this.setFontStyle(e,"--share-text-style-")}initData(){this.addObservableFunc(),super.initData()}}return i.\u0275fac=function(e){return new(e||i)(o.Y36(o.zs3),o.Y36(ht.a))},i.\u0275cmp=o.Xpm({type:i,selectors:[["wdg-other-videocall"]],hostBindings:function(e,n){1&e&&o.NdJ("keydown.escape",function(r){return n.onKeydownHandler(r)},!1,o.evT)},features:[o.qOj],decls:5,vars:3,consts:[[3,"innerHTML",4,"ngIf"],["class","widget other videocall",3,"ngClass","vertical","minimized",4,"ngIf"],[4,"ngIf"],["position","above"],["tooltip",""],[3,"innerHTML"],[1,"widget","other","videocall",3,"ngClass"],["class","list",4,"ngIf"],["mat-mini-fab","","shToolTip","Connect",3,"disabled","shToolTipComponent","click",4,"ngIf"],[1,"list"],[3,"peer","local","host",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"peer","local","host"],[3,"peer","host","tooltip",4,"ngIf"],[3,"peer","host","tooltip"],["mat-mini-fab","","shToolTip","Connect",3,"disabled","shToolTipComponent","click"],[3,"icon"],[1,"buttons"],["mat-mini-fab","",3,"shToolTip","shToolTipComponent","click"],["mat-mini-fab","",3,"disabled","shToolTip","shToolTipComponent","click"],["mat-mini-fab","","shToolTip","Share",3,"shToolTipComponent","click"],["mat-mini-fab","","shToolTip","Disconnect",1,"active",3,"shToolTipComponent","click"],["mat-mini-fab","","shToolTip","Toggle",1,"toggle",3,"shToolTipComponent","click"],[1,"share-bg",3,"click"],[1,"share-modal"],[1,"input"],["type","text","readOnly","",3,"ngModel","ngModelChange","click"],["shareInput",""],["mat-button","",3,"click"],[1,"share-notification"]],template:function(e,n){1&e&&(o.YNc(0,_t,2,4,"code",0),o.YNc(1,Ot,4,8,"div",1),o.YNc(2,kt,12,5,"ng-container",2),o._UZ(3,"sh-tool-tip",3,4)),2&e&&(o.Q6J("ngIf",n.styles),o.xp6(1),o.Q6J("ngIf",n.widgetInit&&n.widget),o.xp6(1),o.Q6J("ngIf",n.shareActive))},dependencies:[_.mk,_.sg,_.O5,_e.o,u.lW,pt.I,ve.h,m.Fj,m.JJ,m.On,gt,yt.y],styles:[".videocall[_ngcontent-%COMP%]{z-index:9;position:absolute;color:var(--text-color);margin:var(--margin);display:flex;align-items:center;flex-direction:column}.videocall.top[_ngcontent-%COMP%], .videocall.top-left[_ngcontent-%COMP%], .videocall.top-right[_ngcontent-%COMP%]{top:0}.videocall.bottom[_ngcontent-%COMP%], .videocall.bottom-left[_ngcontent-%COMP%], .videocall.bottom-right[_ngcontent-%COMP%]{bottom:0}.videocall.bottom-left[_ngcontent-%COMP%], .videocall.left[_ngcontent-%COMP%], .videocall.top-left[_ngcontent-%COMP%]{left:0}.videocall.bottom-right[_ngcontent-%COMP%], .videocall.right[_ngcontent-%COMP%], .videocall.top-right[_ngcontent-%COMP%]{right:0}.videocall.bottom[_ngcontent-%COMP%], .videocall.top[_ngcontent-%COMP%]{left:50%;transform:translate(-50%);margin-left:0;margin-right:0}.videocall.left[_ngcontent-%COMP%], .videocall.right[_ngcontent-%COMP%]{top:50%;transform:translateY(-50%);margin-top:0;margin-bottom:0}.videocall.bottom[_ngcontent-%COMP%], .videocall.bottom-left[_ngcontent-%COMP%], .videocall.bottom-right[_ngcontent-%COMP%]{flex-direction:column-reverse}.videocall.vertical[_ngcontent-%COMP%]{flex-direction:row}.videocall.vertical[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%], .videocall.vertical[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{flex-direction:column}.videocall.vertical[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{margin:0 var(--margin)}.videocall.vertical.bottom-right[_ngcontent-%COMP%], .videocall.vertical.right[_ngcontent-%COMP%], .videocall.vertical.top-right[_ngcontent-%COMP%]{flex-direction:row-reverse}.videocall[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{display:flex;gap:10px;flex-wrap:wrap}.videocall[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   wdg-other-videocall-user[_ngcontent-%COMP%]{width:var(--size);flex:1;border-radius:var(--border-radius-top-left) var(--border-radius-top-right) var(--border-radius-bottom-right) var(--border-radius-bottom-left)}.videocall[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:inherit;background:var(--background)}.videocall[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.3}.videocall[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--active-color)}.videocall[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{margin:var(--margin) 0;display:flex;gap:10px}.videocall.minimized[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%], .videocall.minimized[_ngcontent-%COMP%]   .share-notification[_ngcontent-%COMP%], .videocall.minimized[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:not(.toggle){display:none}.share-bg[_ngcontent-%COMP%], .share-modal[_ngcontent-%COMP%], .share-notification[_ngcontent-%COMP%]{position:absolute;font-size:14px;z-index:999}.share-bg[_ngcontent-%COMP%]{background-color:#00000080;top:0;left:0;width:100%;height:100%}.share-modal[_ngcontent-%COMP%]{top:50%;left:50%;transform:translate(-50%,-50%);display:flex;gap:5px;flex-direction:column;background:var(--background);padding:10px 20px;border-radius:3px;width:300px;max-width:100%}.share-modal[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-style:var(--share-text-style-font-style);font-weight:var(--share-text-style-font-weight);-webkit-text-decoration:var(--share-text-style-text-decoration);text-decoration:var(--share-text-style-text-decoration);font-size:var(--share-text-style-font-size);font-family:var(--share-text-style-font-family);text-align:var(--share-text-style-text-align);line-height:var(--share-text-style-line-height);color:var(--share-text-style-color)}.share-modal[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]{display:flex;position:relative;color:#fff}.share-modal[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:rgba(0,0,0,.5);border:none;border-radius:3px;padding:0 28px 0 8px;line-height:26px;font-size:12px;box-sizing:border-box;width:100%;border:1px solid transparent;color:inherit}.share-modal[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:absolute;right:0;top:0;width:28px;height:100%;line-height:0}.share-notification[_ngcontent-%COMP%]{bottom:10px;left:50%;transform:translate(-50%);background:var(--background);padding:10px 20px;border-radius:5px;white-space:nowrap;position:absolute;visibility:hidden}code[_ngcontent-%COMP%]{display:none}"]}),i})(),Pt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=o.oAB({type:i,bootstrap:[Mt]}),i.\u0275inj=o.cJS({imports:[_.ez,C.D,v.Q,u.ot,p.y,m.u5]}),i})()}}]);