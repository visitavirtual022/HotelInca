"use strict";(self.webpackChunktourmkr_download=self.webpackChunktourmkr_download||[]).push([[102],{354:(w,_,o)=>{o.d(_,{o:()=>t});var a=o(8692),r=o(4537);function g(p,c){if(1&p&&(r.O4$(),r.TgZ(0,"svg",1),r._UZ(1,"path",2),r.qZA()),2&p){const l=r.oxw();r.uIk("data-prefix",l.icon.prefix)("data-icon",l.icon.iconName)("viewBox","0 0 "+l.icon.icon[0]+" "+l.icon.icon[1]),r.xp6(1),r.uIk("d",l.icon.icon[4])}}let t=(()=>{class p{constructor(l,d){this.elRef=l,this.platformId=d}iconTransform(){!(0,a.NF)(this.platformId)||this.elRef.nativeElement.style.setProperty("--transform",this.icon&&this.icon.icon&&this.icon.icon[0]!=this.icon.icon[1]&&this.icon.icon[0]/this.icon.icon[1]>.8?"scale("+this.icon.icon[0]/this.icon.icon[1]+")":null)}ngOnInit(){this.iconTransform()}ngOnChanges(l){void 0!==l.icon&&this.iconTransform()}}return p.\u0275fac=function(l){return new(l||p)(r.Y36(r.SBq),r.Y36(r.Lbi))},p.\u0275cmp=r.Xpm({type:p,selectors:[["sh-icon"]],inputs:{icon:"icon"},features:[r.TTD],decls:1,vars:1,consts:[["role","img","aria-hidden","true","focusable","false","xmlns","http://www.w3.org/2000/svg",4,"ngIf"],["role","img","aria-hidden","true","focusable","false","xmlns","http://www.w3.org/2000/svg"],["fill","currentColor"]],template:function(l,d){1&l&&r.YNc(0,g,2,4,"svg",0),2&l&&r.Q6J("ngIf",d.icon&&d.icon.icon)},dependencies:[a.O5],styles:["[_nghost-%COMP%]{width:14px;height:14px;display:inline-block;line-height:0;transform:var(--transform)}svg[_ngcontent-%COMP%]{max-width:100%;max-height:100%;width:100%;height:100%}"]}),p})()},6031:(w,_,o)=>{o.d(_,{Q:()=>g});var a=o(8692),r=o(4537);let g=(()=>{class t{}return t.\u0275fac=function(c){return new(c||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[a.ez]}),t})()},7072:(w,_,o)=>{o.d(_,{o:()=>c});var a=o(4537),r=o(4091),g=o(6101),t=o(7343),p=o(7493);class c{constructor(d){this.injector=d,this.elRef=this.injector.get(a.SBq),this.i18n=this.injector.get(g.T),this.fontsService=this.injector.get(r.C),this.panoService=this.injector.get(t.X),this.statsService=this.injector.get(p.G)}_updateFontStyle(d,O){!d||Object.keys(O).filter(s=>["family","align","size","line_height"].includes(s)).forEach(s=>{d[s]||(d[s]=O[s])})}}},4507:(w,_,o)=>{o.d(_,{D:()=>r});var a=o(4537);let r=(()=>{class g{}return g.\u0275fac=function(p){return new(p||g)},g.\u0275mod=a.oAB({type:g}),g.\u0275inj=a.cJS({}),g})()},7239:(w,_,o)=>{o.d(_,{y:()=>g});var a=o(4537),r=o(5998);let g=(()=>{class t{constructor(c){this.sanitizer=c}transform(c,l){switch(l){case"html":return this.sanitizer.bypassSecurityTrustHtml(c);case"style":return this.sanitizer.bypassSecurityTrustStyle(c);case"script":return this.sanitizer.bypassSecurityTrustScript(c);case"url":return this.sanitizer.bypassSecurityTrustUrl(c);case"resourceUrl":return this.sanitizer.bypassSecurityTrustResourceUrl(c);default:throw new Error(`Invalid safe type specified: ${l}`)}}}return t.\u0275fac=function(c){return new(c||t)(a.Y36(r.H7,16))},t.\u0275pipe=a.Yjl({name:"safe",type:t,pure:!0}),t})()},7493:(w,_,o)=>{o.d(_,{G:()=>l});var a=o(4537),r=o(8692),g=o(5732),t=o(8066),p=o(5056),c=o(7343);let l=(()=>{class d{constructor(s,m,v,S,M){this.http=s,this.windowRef=m,this.viewerDataService=v,this.panoService=S,this.platformId=M,this.session_id=""}send(s){if((0,r.PM)(this.platformId)||this.viewerDataService.editor||!this.panoService.moderationUrl)return;this.session_id||(this.session_id=(Math.random().toString(36).slice(2)+Date.now().toString(36)).substr(0,16));let m=this._getStats();0!=m.host.indexOf("localhost")&&(null!=s.type&&(m.type=s.type),null!=s.plugin&&(m.plugin=s.plugin),null!=s.details&&(m.details=s.details),this.http.post("https://apiw.gothru.co/tours/stats",m).subscribe())}getWidget(s){let v=[{name:"Berlin Menu",component:"MenuHopenkeComponent"},{name:"Side Menu",component:"MenuKavftigComponent"},{name:"Top Menu",component:"MenuLekprogComponent"},{name:"Real Estate Menu",component:"MenuLoppitteComponent"},{name:"Berlin Map",component:"SchemeHopenkeComponent"},{name:"Floor Map",component:"SchemeKavftigComponent"},{name:"Mapbox",component:"SchemeGvesjodComponent"},{name:"Berlin Hotspot",component:"HotspotHopenkeComponent"},{name:"Hotspot",component:"HotspotKavftigComponent"},{name:"Pano link",component:"HotspotHolmlackComponent"},{name:"Berlin Control",component:"ControlHopenkeComponent"},{name:"Control Bar",component:"ControlKavftigComponent"},{name:"Real Estate Control",component:"ControlLoppitteComponent"},{name:"Carousel",component:"OtherCarouselComponent"},{name:"Language",component:"OtherLanguageComponent"},{name:"Logo",component:"OtherLogoComponent"},{name:"Code",component:"OtherCodeComponent"},{name:"Password",component:"OtherPasswordComponent"},{name:"Pano Label",component:"OtherTitleComponent"}].filter(S=>S.component==s).pop();return v?{name:v.name,key:v.name.toLowerCase().replace(" ","_")}:{name:"",key:""}}_getStats(){let s={ip:null,action:null,returning:null,user_type:null,time:null,m_key:null,user_id:this.panoService.user_id,session_id:this.session_id,browser:this.windowRef.nativeWindow.navigator.userAgent,height:this.windowRef.nativeWindow.innerHeight,language:this.windowRef.nativeWindow.navigator.language,location:this.windowRef.nativeWindow.location.href,moderation_id:this.viewerDataService.active.t_id,pano_id:this.viewerDataService.active.id,referer:document.referrer,site:this.panoService.moderationUrl.substr(2),local_time:Math.floor(Date.now()/1e3),width:this.windowRef.nativeWindow.innerWidth,device:null,host:null,tour_type:null,plugin:null,type:null,details:null};return this.panoService.googleApiKey&&(s.m_key=this.panoService.googleApiKey),s.device=this.windowRef.nativeWindow.innerWidth<600?"mobile":this.windowRef.nativeWindow.innerWidth>=600&&this.windowRef.nativeWindow.innerWidth<1e3?"tablet":"desktop",s.host=s.location.split("/")[2],s.tour_type=0==this.panoService.moderationUrl.indexOf("G")?"google":"hosted",s}}return d.\u0275fac=function(s){return new(s||d)(a.LFG(g.eN),a.LFG(t.X),a.LFG(p.m),a.LFG(c.X),a.LFG(a.Lbi))},d.\u0275prov=a.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},9115:(w,_,o)=>{o.r(_),o.d(_,{OtherHotspotSearchModule:()=>I});var a=o(8692),r=o(6031),g=o(4507),t=o(4537),p=o(8041),c=o(9911);const l=JSON.parse('{"widget":"OtherHotspotSearchComponent","show":false,"panos":[],"options":[{"key":"to_control","label":"Move button to control bar","type":"toggle","category":"content","help":"only for \\"Berlin\\" and \\"Control bar\\" plugins","value":false},{"key":"placeholder","label":"Placeholder","type":"text","category":"content","value":{"en":"Search..."}},{"key":"margin","label":"Margin","hide":false,"type":"slider","category":"appearance","help":"px","value":20},{"key":"area","label":"Area","hide":false,"areas":["top","bottom","left","right","top-left","top-right","bottom-left","bottom-right"],"type":"area","category":"appearance","value":"top-right"},{"key":"shadow","label":"Shadow","type":"shadow","category":"appearance","value":"shadow-depth-3"},{"key":"colors","type":"color-bundle","category":"colors","value":{"common_color":false,"background":{"type":"native","color":"rgb(45 45 45)"},"active_color":{"type":"native","color":"rgb(0 120 241)"},"text_color":{"color":"rgba(255,255,255,97)"}}},{"key":"wrapper-background","label":"Wrapper background","type":"color","category":"colors","value":{"color":"rgba(0,0,0,0.1)"}},{"key":"styles","label":"Styles","type":"css","category":"styles","value":""}]}');var d=o(4445),O=o(2001),s=o(6883),m=o(354),v=o(7267);let S=(()=>{class i{constructor(e,n){this.otherService=e,this.controlService=n,this.toControl=!1,this.showChange=new t.vpe,this.hotspotsCountChange=new t.vpe}toggleOptions(){this.controlService.control&&-1!=["ControlKavftigComponent","ControlHopenkeComponent"].indexOf(this.controlService.control.widget)&&(this.toControl?(this.otherService.getWidgetOption("OtherHotspotSearchComponent","margin").hide=!0,this.otherService.getWidgetOption("OtherHotspotSearchComponent","area").hide=!0,this.controlService.control.tools.filter(e=>"hotspot_search"==e.key).pop()||this.controlService.control.tools.push({key:"hotspot_search",name:"Hotspot search",icon:{prefix:"fal",iconName:"search-location",icon:[512,512,[],"f060","M208 96c-49.53 0-89.81 40.3-89.81 89.83 0 34.66 38.34 87.2 70.53 125.2 4.81 5.7 11.84 8.97 19.28 8.97s14.47-3.27 19.31-8.97c32.16-38 70.5-90.55 70.5-125.2C297.81 136.3 257.53 96 208 96zm0 188.23c-35.31-42.7-57.81-80.89-57.81-98.41 0-31.89 25.94-57.83 57.81-57.83s57.81 25.94 57.81 57.83c0 17.52-22.5 55.71-57.81 98.41zM208 160c-13.25 0-24 10.74-24 24 0 13.25 10.75 24 24 24s24-10.75 24-24c0-13.26-10.75-24-24-24zm300.47 321.58l-128.99-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3c34.3-37.1 55.3-86.6 55.3-141.09C415.98 93.1 322.88 0 207.99 0S0 93.1 0 207.99c0 114.89 93.1 207.99 207.99 207.99 54.5 0 103.99-21 141.09-55.2v10.2c0 3.2 1.3 6.2 3.5 8.5l128.99 128.99c4.7 4.7 12.3 4.7 17 0l9.9-9.9c4.71-4.69 4.71-12.29 0-16.99zm-300.48-97.6C110.7 383.98 32 305.29 32 207.99 32 110.69 110.7 32 207.99 32s175.99 78.7 175.99 175.99c0 97.3-78.69 175.99-175.99 175.99z"]},visible:!0,responsive:{desktop:!0,tablet:!0,mobile:!0}})):(this.otherService.getWidgetOption("OtherHotspotSearchComponent","margin").hide=!1,this.otherService.getWidgetOption("OtherHotspotSearchComponent","area").hide=!1,this.controlService.control.tools=this.controlService.control.tools.filter(e=>"hotspot_search"!=e.key)))}ngOnChanges(e){void 0!==e.toControl&&this.toggleOptions(),void 0!==e.show&&this.showChange.emit(this.show),void 0!==e.hotspotCount&&this.hotspotsCountChange.emit(this.hotspotCount)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(v.m),t.Y36(s.B))},i.\u0275cmp=t.Xpm({type:i,selectors:[["wdg-other-hotspot-search-actions"]],inputs:{show:"show",toControl:"toControl",hotspotCount:"hotspotCount"},outputs:{showChange:"showChange",hotspotsCountChange:"hotspotsCountChange"},features:[t.TTD],decls:0,vars:0,template:function(e,n){},encapsulation:2}),i})();var M=o(7239);const y=["search"];function P(i,u){if(1&i&&(t._UZ(0,"code",2),t.ALo(1,"safe")),2&i){const e=t.oxw();t.Q6J("innerHTML",t.xi3(1,1,e.styles,"html"),t.oJD)}}function x(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"div",8),t.NdJ("click",function(){t.CHM(e);const h=t.oxw(2);return t.KtG(h.toggle())}),t._UZ(1,"sh-icon",9),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("ngClass",e.options.area.value),t.xp6(1),t.Q6J("icon",e.icons[0])}}function b(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"div",10),t.NdJ("click",function(){t.CHM(e);const h=t.oxw(2);return t.KtG(h.toggle())}),t.qZA()}}function H(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"li",16),t.NdJ("click",function(){const f=t.CHM(e).$implicit,C=t.oxw(3);return t.KtG(C.openHotspot(f))}),t._uU(1),t.qZA()}if(2&i){const e=u.$implicit,n=t.oxw(3);t.xp6(1),t.hij(" ",n.getHotspotTitle(e)," ")}}function E(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"div",11)(1,"input",12,13),t.NdJ("input",function(h){t.CHM(e);const f=t.oxw(2);return t.KtG(f.searhChange(h))}),t.qZA(),t.TgZ(3,"ul",14),t.YNc(4,H,2,1,"li",15),t.qZA()()}if(2&i){const e=t.oxw(2);t.Q6J("ngClass",e.options.shadow.value),t.xp6(1),t.uIk("placeholder",e.i18n.t(e.options.placeholder.value)),t.xp6(3),t.Q6J("ngForOf",e.foundHotspots)}}function T(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"div",3),t.YNc(1,x,2,2,"div",4),t.YNc(2,b,1,0,"div",5),t.YNc(3,E,5,3,"div",6),t.TgZ(4,"wdg-other-hotspot-search-actions",7),t.NdJ("showChange",function(h){t.CHM(e);const f=t.oxw();return t.KtG(f.onShowChange(h))})("hotspotsCountChange",function(){t.CHM(e);const h=t.oxw();return t.KtG(h.onHotspotsCountChange())}),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!e.options.to_control.value),t.xp6(1),t.Q6J("ngIf",e.widget.show),t.xp6(1),t.Q6J("ngIf",e.widget.show),t.xp6(1),t.Q6J("show",e.widget.show)("toControl",e.options.to_control.value)("hotspotCount",e.hotspotCount)}}let D=(()=>{class i extends p.P{constructor(e,n,h,f){super(e),this.hotspotService=n,this.viewerService=h,this.controlService=f,this.default_options=l,this.icons=[{prefix:"fal",iconName:"search-location",icon:[512,512,[],"f689","M208 96c-49.53 0-89.81 40.3-89.81 89.83 0 34.66 38.34 87.2 70.53 125.2 4.81 5.7 11.84 8.97 19.28 8.97s14.47-3.27 19.31-8.97c32.16-38 70.5-90.55 70.5-125.2C297.81 136.3 257.53 96 208 96zm0 188.23c-35.31-42.7-57.81-80.89-57.81-98.41 0-31.89 25.94-57.83 57.81-57.83s57.81 25.94 57.81 57.83c0 17.52-22.5 55.71-57.81 98.41zM208 160c-13.25 0-24 10.74-24 24 0 13.25 10.75 24 24 24s24-10.75 24-24c0-13.26-10.75-24-24-24zm300.47 321.58l-128.99-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3c34.3-37.1 55.3-86.6 55.3-141.09C415.98 93.1 322.88 0 207.99 0S0 93.1 0 207.99c0 114.89 93.1 207.99 207.99 207.99 54.5 0 103.99-21 141.09-55.2v10.2c0 3.2 1.3 6.2 3.5 8.5l128.99 128.99c4.7 4.7 12.3 4.7 17 0l9.9-9.9c4.71-4.69 4.71-12.29 0-16.99zm-300.48-97.6C110.7 383.98 32 305.29 32 207.99 32 110.69 110.7 32 207.99 32s175.99 78.7 175.99 175.99c0 97.3-78.69 175.99-175.99 175.99z"]}],this.foundHotspots=[]}get hotspotCount(){return this.hotspotService.hotspots.length}openHotspot(e){this.widget.show=!1,this.viewerService.active.id==e.pano.id?this.hotspotService.open(e.id):this.hotspotService.tempActiveId=e.id,this.viewerService.goToPano(e.pano.id,e.position,!0)}searhChange(e){let n=e.target.value;if(!n)return void(this.foundHotspots=[]);let h=this.hotspotService.hotspots.filter(C=>!C.parent_id&&-1!=this.getHotspotTitle(C).toLowerCase().indexOf(n.toLowerCase())),f=this.hotspotService.hotspots.filter(C=>!C.parent_id&&-1!=C.tags.toLowerCase().indexOf(n.toLowerCase()));this.foundHotspots=h.concat(f)}getWidgetName(e){let n;switch(e){case"HotspotHolmlackComponent":n="Pano link";break;case"HotspotHopenkeComponent":n="Berlin";break;case"HotspotKavftigComponent":n="Hotspot";break;default:n="Unknown"}return n}getHotspotTitle(e){let n=e.hotspot_title;return e.parent_id&&(n=this.hotspotService.getHotspotById(e.parent_id).hotspot_title),this.i18n.t(n)||this.getWidgetName(e.widget)}getHotspotTag(e,n){return n.tags&&e&&n.tags.split(", ").filter(h=>-1!=h.toLowerCase().indexOf(e.toLowerCase())).pop()||""}getHotspotTagWithout(e,n){return n.tags?(e?n.tags.split(", ").filter(h=>-1==h.toLowerCase().indexOf(e.toLowerCase())):n.tags.split(", ")).join(" "):""}onShowChange(e){e?setTimeout(()=>{this.search.nativeElement.focus()}):this.foundHotspots=[]}onHotspotsCountChange(){!this.viewerService.editor||(this.widget.panos=[],this.hotspotService.hotspots.forEach(e=>{e.parent_id||this.widget.panos.push(e.pano.id)}))}addObservableFunc(){this.observableFunc.margin=e=>this.onMarginChange(e),this.observableFunc.wrapper_background=e=>{this.onWrapperBackgroundChange(e)}}onMarginChange(e){this.elRef.nativeElement.style.setProperty("--margin",e+"px")}onWrapperBackgroundChange(e){this.elRef.nativeElement.style.setProperty("--wrapper-background",c.v.backgroundStyle(e))}loadPanoramas(){this.viewerService.editor||!(0,a.NF)(this.panoService.platformId)||c.v.waitUntil(()=>null!=this.viewerService.viewerService).then(()=>{this.widget?.panos?.forEach(e=>{this.viewerService.viewerService.loadPano(e)})})}initData(){this.addObservableFunc(),super.initData(),this.widget.show=!1,this.loadPanoramas()}ngOnDestroy(){this.controlService.control&&this.controlService.control.tools&&(this.controlService.control.tools=this.controlService.control.tools.filter(e=>"hotspot_search"!=e.key))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.zs3),t.Y36(d.N),t.Y36(O.a),t.Y36(s.B))},i.\u0275cmp=t.Xpm({type:i,selectors:[["wdg-other-hotspot-search"]],viewQuery:function(e,n){if(1&e&&t.Gf(y,5,t.SBq),2&e){let h;t.iGM(h=t.CRH())&&(n.search=h.first)}},features:[t.qOj],decls:2,vars:2,consts:[[3,"innerHTML",4,"ngIf"],["class","widget other",4,"ngIf"],[3,"innerHTML"],[1,"widget","other"],["class","search-button",3,"ngClass","click",4,"ngIf"],["class","search-bg",3,"click",4,"ngIf"],["class","search-input",3,"ngClass",4,"ngIf"],[3,"show","toControl","hotspotCount","showChange","hotspotsCountChange"],[1,"search-button",3,"ngClass","click"],[3,"icon"],[1,"search-bg",3,"click"],[1,"search-input",3,"ngClass"],["type","text",3,"input"],["search",""],[1,"scrollbar"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(e,n){1&e&&(t.YNc(0,P,2,4,"code",0),t.YNc(1,T,5,6,"div",1)),2&e&&(t.Q6J("ngIf",n.styles),t.xp6(1),t.Q6J("ngIf",n.widgetInit&&n.widget))},dependencies:[a.mk,a.sg,a.O5,m.o,S,M.y],styles:[".search-button[_ngcontent-%COMP%]{position:absolute;z-index:2;overflow:hidden;display:flex;justify-content:center;align-items:center;width:40px;height:40px;border-radius:3px;cursor:pointer;margin:var(--margin);background:var(--background);color:var(--text-color)}.search-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:16px;max-width:16px;max-height:16px}.search-button.top[_ngcontent-%COMP%]{top:0;left:50%;transform:translate(-50%)}.search-button.bottom[_ngcontent-%COMP%]{bottom:0;left:50%;transform:translate(-50%)}.search-button.left[_ngcontent-%COMP%]{top:50%;left:0;transform:translateY(-50%)}.search-button.right[_ngcontent-%COMP%]{top:50%;right:0;transform:translateY(-50%)}.search-button.top-left[_ngcontent-%COMP%]{top:0;left:0}.search-button.top-right[_ngcontent-%COMP%]{top:0;right:0}.search-button.bottom-left[_ngcontent-%COMP%]{bottom:0;left:0}.search-button.bottom-right[_ngcontent-%COMP%]{right:0;bottom:0}.search-bg[_ngcontent-%COMP%], .search-input[_ngcontent-%COMP%]{z-index:100}.search-bg[_ngcontent-%COMP%]{position:absolute;top:0;left:0;background-color:var(--wrapper-background);width:100%;height:100%}.search-input[_ngcontent-%COMP%]{position:absolute;top:20%;left:50%;width:300px;max-width:100%;transform:translate(-50%);color:var(--text-color);background:var(--background);border-radius:5px}.search-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:40px;padding:0 20px;border:none;outline:none;box-sizing:border-box;background-color:transparent;font-size:inherit;font-size:18px;color:inherit}.search-input[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;max-height:400px;font-size:14px}.search-input[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:5px 20px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;position:relative;cursor:pointer}.search-input[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   span.tags[_ngcontent-%COMP%]{font-size:12px}.search-input[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   span.tags[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{font-weight:bolder}.search-input[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background:var(--active-color)}code[_ngcontent-%COMP%]{display:none}"]}),i})(),I=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i,bootstrap:[D]}),i.\u0275inj=t.cJS({imports:[a.ez,r.Q,g.D]}),i})()}}]);