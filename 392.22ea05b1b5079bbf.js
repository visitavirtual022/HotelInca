"use strict";(self.webpackChunktourmkr_download=self.webpackChunktourmkr_download||[]).push([[392],{4392:(L,l,a)=>{a.r(l),a.d(l,{SchemeHopenkeModule:()=>U});var m=a(8692),h=a(2288),p=a(9638),g=a(6031),_=a(4507),u=a(384),f=a(5573);const v=JSON.parse('{"widget":"SchemeHopenkeComponent","image":"","area":"top-right","areas":["top-left","top-right","bottom-left","bottom-right"],"show_on_load":true,"styles":"","common_color":false,"background":{"type":"native","color":"rgb(22,160,133)"},"active_color":{"type":"native","color":"rgb(103,58,183)"},"text_color":{"color":"rgb(255,255,255)"},"dot_background":{"type":"native","color":"rgb(234,189,0)"},"border_radius":{"topLeft":0,"topRight":0,"bottomLeft":0,"bottomRight":0},"zoom":1,"zoom_max":2,"margin":20,"border_size":5,"map_angle":0,"map_width":240,"map_height":240,"map_max_width":400,"map_max_height":400,"map_fullscreen_width":80,"map_fullscreen_height":60,"dot_size":18,"dots":[],"multiple_map":false}');var e=a(4537),k=a(354),d=a(9911),C=a(6101),x=a(2001),b=a(4827),M=a(7343),w=a(7493),O=a(6369);const P=["dragZoom"];function S(n,r){if(1&n&&(e.TgZ(0,"span",6),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit,o=e.oxw();e.Udp("bottom",o.map.dot_size/2+2,"px"),e.xp6(1),e.Oqu(o.i18n.t(t.name))}}function z(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"span",3),e.NdJ("cdkDragStarted",function(i){e.CHM(t);const c=e.oxw();return e.KtG(c.onDragStart(i))})("cdkDragEnded",function(i){const s=e.CHM(t).$implicit,E=e.oxw();return e.KtG(E.onDragEnd(i,s.pos))}),e.YNc(1,S,2,3,"span",4),e.TgZ(2,"button",5),e.NdJ("click",function(){const c=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.goToPano(c))}),e.qZA()()}if(2&n){const t=r.$implicit,o=e.oxw();e.Udp("left",t.pos.x,"%")("top",t.pos.y,"%"),e.Q6J("cdkDragDisabled",!o.editorMode),e.xp6(1),e.Q6J("ngIf",o.i18n.t(t.name)),e.xp6(1),e.Udp("width",o.scheme.dot_size,"px")("height",o.scheme.dot_size,"px")("transform","translate(-50%,-50%) rotate("+(o.angle+o.map.map_angle-90)+"deg)"),e.ekj("active",t.pano.id==o.active)}}let y=(()=>{class n{constructor(t,o,i,c,s){this.i18n=t,this.viewerService=o,this.schemeService=i,this.panoService=c,this.statsService=s,this.zoom=1}changeOffset(t,o){this.dragZoom.updateParams({width:Math.min(t,this.viewerService.overlayWidth-2*(this.scheme.margin+this.scheme.border_size)),height:Math.min(o,this.viewerService.overlayHeight-2*(this.scheme.margin+this.scheme.border_size))},"all 0.5s ease")}goToPano(t){if(!t.pano||this.active==t.pano.id)return;this.viewerService.goToPano(t.pano.id,{theta:t.theta,phi:t.phi}),"mobile"==this.viewerService.overlayDeviceClass&&this.schemeService.toggle();let o=this.statsService.getWidget(this.schemeService.scheme.widget);this.statsService.send({plugin:o.name,type:o.key,details:t.pano.id})}get angle(){return this.viewerService.angle}get scheme(){return this.schemeService.scheme}get editorMode(){return this.viewerService.editor}onDragStart(t){!this.dragZoom||(this.dragZoom.disableDragging=!0)}onDragEnd(t,o){!this.dragZoom||(setTimeout(()=>{this.dragZoom.disableDragging=!1}),t.source.reset(),o.x=parseFloat((o.x+100*t.distance.x/this.dragZoom.params.width).toFixed(2)),o.y=parseFloat((o.y+100*t.distance.y/this.dragZoom.params.height).toFixed(2)))}__getLastActive(){}_makeCenter(){let t;if(this.map?.dots){for(let o=this.map.dots.length-1;o>=0;o--){const i=this.map.dots[o];if(i.pano.id===this.active){t=i;break}}!t||this.dragZoom.setPosition(t.pos,"all 0.3s ease")}}makeCenter(){this.dragZoom?.params.width?this._makeCenter():d.v.waitUntil(()=>0!==this.dragZoom.params.width).then(()=>this._makeCenter())}updateDotsPosByVersion(){parseFloat(this.panoService.data_version)>=2.09||d.v.waitUntil(()=>0!==this.dragZoom.params.width).then(()=>{this.map.dots.forEach(t=>{!t.pos||(t.pos.x=parseFloat((t.pos.x/this.dragZoom.params.originalWidth*100).toFixed(2)),t.pos.y=parseFloat((t.pos.y/this.dragZoom.params.originalHeight*100).toFixed(2)))}),this.makeCenter()})}ngOnChanges(t){void 0!==t.map&&this.updateDotsPosByVersion(),(void 0!==t.active||void 0!==t.dots)&&this.makeCenter(),void 0!==t.zoom&&this.dragZoom?.setZoom(this.zoom)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(C.T),e.Y36(x.a),e.Y36(b.p),e.Y36(M.X),e.Y36(w.G))},n.\u0275cmp=e.Xpm({type:n,selectors:[["wdg-scheme-hopenke-map"]],viewQuery:function(t,o){if(1&t&&e.Gf(P,5),2&t){let i;e.iGM(i=e.CRH())&&(o.dragZoom=i.first)}},inputs:{map:"map",wrapper:"wrapper",active:"active",zoom:"zoom",dots:"dots",zoomMax:"zoomMax"},features:[e.TTD],decls:3,vars:3,consts:[[3,"imgSrc","zoom"],["dragZoom",""],["class","marker-wrapper","cdkDrag","","cdkDragBoundary",".content",3,"left","top","cdkDragDisabled","cdkDragStarted","cdkDragEnded",4,"ngFor","ngForOf"],["cdkDrag","","cdkDragBoundary",".content",1,"marker-wrapper",3,"cdkDragDisabled","cdkDragStarted","cdkDragEnded"],["class","name",3,"bottom",4,"ngIf"],["mat-mini-fab","","aria-label","marker",1,"marker",3,"click"],[1,"name"]],template:function(t,o){1&t&&(e.TgZ(0,"sh-drag-zoom",0,1),e.YNc(2,z,3,14,"span",2),e.qZA()),2&t&&(e.Q6J("imgSrc",o.map.image)("zoom",o.zoom),e.xp6(2),e.Q6J("ngForOf",o.map.dots))},dependencies:[m.sg,m.O5,p.lW,h.Zt,O.H],styles:['sh-drag-zoom[_ngcontent-%COMP%]{width:100%;height:100%}.marker-wrapper[_ngcontent-%COMP%]{position:absolute;width:0;height:0}.marker-wrapper[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]{position:absolute;transform:translate(-50%,-50%);border-radius:50%;border:2px solid #fff;padding:0;background:var(--dot-background)}.marker-wrapper[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]     .mat-ripple{background-color:inherit}.marker-wrapper[_ngcontent-%COMP%]   .marker.active[_ngcontent-%COMP%]{background:var(--active-color)}.marker-wrapper[_ngcontent-%COMP%]   .marker.active[_ngcontent-%COMP%]:before{position:absolute;z-index:-1;top:0;left:50%;display:block;width:150%;height:100%;content:"";-webkit-transform:perspective(15px) rotateY(-45deg);background:#fff;background:linear-gradient(to right,rgba(255,255,255,.7) 0%,rgba(255,255,255,0) 100%)}.marker-wrapper[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%]:hover{transform:translate(-50%,-50%) scale(1.2);cursor:pointer}.marker-wrapper[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;font-size:12px;padding:2px 10px;border-radius:2px;transform:translate(-50%);display:none;background:var(--background)}.marker-wrapper[_ngcontent-%COMP%]:hover   .name[_ngcontent-%COMP%]{display:block}']}),n})();var H=a(7239);const Z=["map"];function T(n,r){if(1&n&&(e._UZ(0,"code",2),e.ALo(1,"safe")),2&n){const t=e.oxw();e.Q6J("innerHTML",e.xi3(1,1,t.styles,"html"),e.oJD)}}function D(n,r){1&n&&e.GkF(0)}function J(n,r){if(1&n&&e._UZ(0,"wdg-scheme-hopenke-map",17,18),2&n){e.oxw(2);const t=e.MAs(2),o=e.oxw();e.Q6J("map",o.scheme)("wrapper",t)("active",o.activePano.id)("zoom",o.scheme.zoom)("zoomMax",o.scheme.zoom_max)("dots",o.scheme.dots.length)}}function F(n,r){if(1&n&&e._UZ(0,"wdg-scheme-hopenke-map",17,18),2&n){const t=e.oxw().$implicit;e.oxw(3);const o=e.MAs(2),i=e.oxw();e.Q6J("map",t)("wrapper",o)("active",i.activePano.id)("zoom",i.scheme.zoom)("zoomMax",i.scheme.zoom_max)("dots",t.dots.length)}}function I(n,r){if(1&n&&(e.ynx(0),e.YNc(1,F,2,6,"wdg-scheme-hopenke-map",22),e.BQk()),2&n){const t=r.index,o=e.oxw(4);e.xp6(1),e.Q6J("ngIf",o.schemeService.multipleMapIndex==t)}}function Q(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){const c=e.CHM(t).index,s=e.oxw(4);return e.KtG(s.activate(c))}),e._uU(1),e.qZA()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw(4);e.ekj("active",i.schemeService.multipleMapIndex==o),e.xp6(1),e.hij(" ",i.i18n.t(t.title)," ")}}function N(n,r){if(1&n&&(e.YNc(0,I,2,1,"ng-container",19),e.TgZ(1,"div",20),e.YNc(2,Q,2,3,"button",21),e.qZA()),2&n){const t=e.oxw(3);e.Q6J("ngForOf",t.scheme.multiple_map_data),e.xp6(2),e.Q6J("ngForOf",t.scheme.multiple_map_data)}}function A(n,r){if(1&n&&(e.ynx(0),e.YNc(1,D,1,0,"ng-container",14),e.YNc(2,J,2,6,"ng-template",null,15,e.W1O),e.YNc(4,N,3,2,"ng-template",null,16,e.W1O),e.BQk()),2&n){const t=e.MAs(3),o=e.MAs(5),i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==i.scheme.multiple_map_data)("ngIfThen",t)("ngIfElse",o)}}function G(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",3),e.NdJ("mouseenter",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.maximize())})("mouseleave",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.minimize())}),e.TgZ(1,"div",4,5)(3,"button",6),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.fullscreenOpen())}),e.qZA(),e.TgZ(4,"button",7),e.NdJ("click",function(i){e.CHM(t);const c=e.oxw();return e.KtG(c.fullscreenClose(i))}),e._UZ(5,"sh-icon",8),e.qZA(),e.TgZ(6,"button",9),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.toggle())}),e._UZ(7,"sh-icon",8),e.qZA(),e.TgZ(8,"div",10)(9,"button",11),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.zoomIn())}),e._uU(10,"+"),e.qZA(),e.TgZ(11,"button",12),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.zoomOut())}),e._uU(12,"-"),e.qZA()(),e.YNc(13,A,6,3,"ng-container",13),e.qZA()()}if(2&n){const t=e.MAs(2),o=e.oxw();e.ekj("hide",!o.schemeService.show)("fullscreen",o.fullscreened),e.Q6J("ngClass",o.scheme.area),e.xp6(5),e.Q6J("icon",o.icons[1]),e.xp6(2),e.Q6J("icon",o.icons[0]),e.xp6(6),e.Q6J("ngIf",t&&t.offsetWidth)}}let Y=(()=>{class n extends f.G{constructor(){super(...arguments),this.default_options=v,this.icons=[{prefix:"fal",iconName:"times",icon:[320,512,[],"f00d","M193.94 256L296.5 153.44l21.15-21.15c3.12-3.12 3.12-8.19 0-11.31l-22.63-22.63c-3.12-3.12-8.19-3.12-11.31 0L160 222.06 36.29 98.34c-3.12-3.12-8.19-3.12-11.31 0L2.34 120.97c-3.12 3.12-3.12 8.19 0 11.31L126.06 256 2.34 379.71c-3.12 3.12-3.12 8.19 0 11.31l22.63 22.63c3.12 3.12 8.19 3.12 11.31 0L160 289.94 262.56 392.5l21.15 21.15c3.12 3.12 8.19 3.12 11.31 0l22.63-22.63c3.12-3.12 3.12-8.19 0-11.31L193.94 256z"]},{prefix:"fal",iconName:"window-minimize",icon:[512,512,[128469],"f2d1","M0 464C0 455.2 7.164 448 16 448H496C504.8 448 512 455.2 512 464C512 472.8 504.8 480 496 480H16C7.164 480 0 472.8 0 464z"]}],this.fullscreened=!1}maximize(){this.fullscreened||this.mapComponent.changeOffset(this.scheme.map_max_width,this.scheme.map_max_height)}minimize(){this.fullscreened||this.mapComponent.changeOffset(this.scheme.map_width,this.scheme.map_height)}activate(t){this.schemeService.multipleMapIndex=t}onActivePanoChange(t){this.scheme?.multiple_map_data?.forEach((o,i)=>{o.dots.filter(c=>c.pano.id==t.id).pop()&&this.activate(i)})}fullscreenOpen(){this.fullscreened=!0,this.mapComponent.changeOffset(this.viewerService.overlayWidth*this.scheme.map_fullscreen_width/100,this.viewerService.overlayHeight*this.scheme.map_fullscreen_height/100)}fullscreenClose(t){this.fullscreened=!1,this.maximize(),"mobile"==this.viewerService.overlayDeviceClass&&(this.schemeService.show=!1)}zoomIn(){this.mapComponent.dragZoom.zoomIn()}zoomOut(){this.mapComponent.dragZoom.zoomOut()}ngAfterViewInit(){"mobile"==this.viewerService.overlayDeviceClass&&(this.fullscreened=!0)}}return n.\u0275fac=function(){let r;return function(o){return(r||(r=e.n5z(n)))(o||n)}}(),n.\u0275cmp=e.Xpm({type:n,selectors:[["wdg-scheme-hopenke"]],viewQuery:function(t,o){if(1&t&&e.Gf(Z,5),2&t){let i;e.iGM(i=e.CRH())&&(o.mapComponent=i.first)}},features:[e.qOj],decls:2,vars:2,consts:[[3,"innerHTML",4,"ngIf"],["class","widget scheme scheme-hopenke",3,"ngClass","hide","fullscreen","mouseenter","mouseleave",4,"ngIf"],[3,"innerHTML"],[1,"widget","scheme","scheme-hopenke",3,"ngClass","mouseenter","mouseleave"],[1,"content"],["wrapper",""],["aria-label","open fullscreen",1,"open-tool","tool-btn",3,"click"],["mat-button","","aria-label","minimize",1,"minimize-tool","tool-btn",3,"click"],[3,"icon"],["mat-button","","aria-label","close",1,"close-tool","tool-btn",3,"click"],[1,"zoom-tool"],["mat-button","","aria-label","zoom in",1,"tool-btn",3,"click"],["mat-button","","aria-label","zoom out",1,"tool-btn",3,"click"],[4,"ngIf"],[4,"ngIf","ngIfThen","ngIfElse"],["singleMap",""],["multiMap",""],[3,"map","wrapper","active","zoom","zoomMax","dots"],["map",""],[4,"ngFor","ngForOf"],[1,"map-labels"],["mat-button","","class","map-label",3,"active","click",4,"ngFor","ngForOf"],[3,"map","wrapper","active","zoom","zoomMax","dots",4,"ngIf"],["mat-button","",1,"map-label",3,"click"]],template:function(t,o){1&t&&(e.YNc(0,T,2,4,"code",0),e.YNc(1,G,14,8,"div",1)),2&t&&(e.Q6J("ngIf",o.styles),e.xp6(1),e.Q6J("ngIf",o.widgetInit&&o.scheme))},dependencies:[m.mk,m.sg,m.O5,p.lW,k.o,y,H.y],styles:['.scheme-hopenke[_ngcontent-%COMP%]{position:absolute;z-index:5;display:inline-block;overflow:hidden;-webkit-user-select:none;user-select:none;transition:width .5s ease,height .5s ease,transform .5s ease,top .5s ease,left .5s ease,right .5s ease,bottom .5s ease;transform:translate(0);opacity:1;box-shadow:0 5px 10px #0003;background:var(--background);width:var(--width);height:var(--height);margin:var(--margin);max-width:calc(100% - var(--margin) * 2 - var(--padding) * 2);max-height:calc(100% - var(--margin) * 2 - var(--padding) * 2);padding:var(--padding);color:var(--text-color);border-radius:var(--border-radius-top-left) var(--border-radius-top-right) var(--border-radius-bottom-right) var(--border-radius-bottom-left)}.scheme-hopenke.hide[_ngcontent-%COMP%]{visibility:hidden;opacity:0}.scheme-hopenke.top-right[_ngcontent-%COMP%]{top:0;right:0}.scheme-hopenke.top-left[_ngcontent-%COMP%]{top:0;left:0}.scheme-hopenke.bottom-right[_ngcontent-%COMP%]{right:0;bottom:0}.scheme-hopenke.bottom-left[_ngcontent-%COMP%]{bottom:0;left:0}.scheme-hopenke[_ngcontent-%COMP%]:not(.fullscreen):hover{width:var(--width-max);height:var(--height-max)}.scheme-hopenke[_ngcontent-%COMP%]:not(.fullscreen):hover   .close-tool[_ngcontent-%COMP%], .scheme-hopenke[_ngcontent-%COMP%]:not(.fullscreen):hover   .open-tool[_ngcontent-%COMP%], .scheme-hopenke[_ngcontent-%COMP%]:not(.fullscreen):hover   .zoom-tool[_ngcontent-%COMP%]{opacity:1}.scheme-hopenke[_ngcontent-%COMP%]:not(.fullscreen):hover   .map-labels[_ngcontent-%COMP%]{display:flex}.scheme-hopenke.fullscreen[_ngcontent-%COMP%]{margin:0!important;width:var(--width-full);height:var(--height-full)}.scheme-hopenke.fullscreen.top-right[_ngcontent-%COMP%]{top:50%;right:50%;transform:translate(50%,-50%)}.scheme-hopenke.fullscreen.top-left[_ngcontent-%COMP%]{top:50%;left:50%;transform:translate(-50%,-50%)}.scheme-hopenke.fullscreen.bottom-right[_ngcontent-%COMP%]{right:50%;bottom:50%;transform:translate(50%,50%)}.scheme-hopenke.fullscreen.bottom-left[_ngcontent-%COMP%]{bottom:50%;left:50%;transform:translate(-50%,50%)}.scheme-hopenke.fullscreen[_ngcontent-%COMP%]   .minimize-tool[_ngcontent-%COMP%]{display:block!important}.scheme-hopenke.fullscreen[_ngcontent-%COMP%]   .open-tool[_ngcontent-%COMP%]{display:none}.scheme-hopenke.fullscreen[_ngcontent-%COMP%]   .close-tool[_ngcontent-%COMP%], .scheme-hopenke.fullscreen[_ngcontent-%COMP%]   .minimize-tool[_ngcontent-%COMP%], .scheme-hopenke.fullscreen[_ngcontent-%COMP%]   .zoom-tool[_ngcontent-%COMP%]{opacity:1}.scheme-hopenke.fullscreen[_ngcontent-%COMP%]   .map-labels[_ngcontent-%COMP%]{display:flex}.scheme-hopenke[_ngcontent-%COMP%]   .tool-btn[_ngcontent-%COMP%]{position:absolute;z-index:1;width:28px;height:28px;padding:0;cursor:pointer;outline:none;font-size:22px;line-height:0;min-width:initial}.scheme-hopenke[_ngcontent-%COMP%]   .tool-btn[_ngcontent-%COMP%]   sh-icon[_ngcontent-%COMP%]{width:18px;height:18px}.scheme-hopenke[_ngcontent-%COMP%]   .tool-btn[_ngcontent-%COMP%]     span.mat-button-wrapper{line-height:0}.scheme-hopenke[_ngcontent-%COMP%]   .tool-btn.minimize-tool[_ngcontent-%COMP%]{top:5px;right:38px;display:none;border-radius:2px;background:var(--background);color:var(--text-color)}.scheme-hopenke[_ngcontent-%COMP%]   .open-tool[_ngcontent-%COMP%]{top:5px;left:5px;opacity:0;border-width:0;background:transparent;border-color:var(--background)}.scheme-hopenke[_ngcontent-%COMP%]   .open-tool[_ngcontent-%COMP%]:after{display:block;width:0;height:0;content:"";border-width:24px 24px 0 0;border-style:solid;border-color:transparent;border-top-color:inherit}.scheme-hopenke[_ngcontent-%COMP%]   .close-tool[_ngcontent-%COMP%]{top:5px;right:5px;opacity:0;border-radius:2px;background:var(--background);color:var(--text-color)}.scheme-hopenke[_ngcontent-%COMP%]   .zoom-tool[_ngcontent-%COMP%]{position:absolute;z-index:1;top:38px;right:5px;display:flex;flex-direction:column;transition:top .3s ease;opacity:0;border-radius:2px;background:var(--background)}.scheme-hopenke[_ngcontent-%COMP%]   .zoom-tool[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:relative;background-color:transparent;color:inherit}.scheme-hopenke[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{position:relative;overflow:hidden;height:100%;border-top-left-radius:inherit;border-top-right-radius:inherit;border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.scheme-hopenke[_ngcontent-%COMP%]   .map-labels[_ngcontent-%COMP%]{width:100%;position:absolute;bottom:0;left:0;background:var(--background);display:none}.scheme-hopenke[_ngcontent-%COMP%]   .map-labels[_ngcontent-%COMP%]   .map-label[_ngcontent-%COMP%]{border-radius:0;min-width:0;flex-grow:1}.scheme-hopenke[_ngcontent-%COMP%]   .map-labels[_ngcontent-%COMP%]   .map-label.active[_ngcontent-%COMP%]{color:var(--active-color)}  #overlay.mobile wdg-scheme-kavftig .scheme-hopenke{width:100%!important;height:100%!important}  #overlay.mobile wdg-scheme-kavftig .scheme-hopenke .zoom-tool{opacity:1}code[_ngcontent-%COMP%]{display:none}']}),n})(),U=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n,bootstrap:[Y]}),n.\u0275inj=e.cJS({imports:[m.ez,p.ot,h._t,g.Q,_.D,u.a]}),n})()}}]);